# 清理 R2 错误文件夹说明

## 问题描述

R2 存储中出现了错误的文件夹结构：`package/package/`，这会导致文件组织混乱。

## 清理步骤

### 方法一：使用批处理文件（推荐）

1. **双击运行** `clean-error-folder.bat`

2. **查看文件列表**  
   脚本会显示所有需要删除的文件信息，包括：
   - 文件路径
   - 文件大小
   - 修改时间
   - 总计文件数和总大小

3. **确认删除**  
   系统会询问：`确定要删除这些文件吗？(y/n):`
   - 输入 `y` 或 `yes` 确认删除
   - 输入 `n` 或 `no` 取消操作

4. **等待完成**  
   脚本会显示删除进度和最终统计结果

### 方法二：使用命令行

```bash
node clean-package-error.js
```

## 安全提示

⚠️ **重要提醒**：
- 删除操作**不可恢复**，请在确认前仔细检查文件列表
- 脚本只会删除 `package/package/` 路径下的文件
- 不会影响 `package/2025-09/`、`package/2025-10/` 等正确路径的文件

## 脚本功能

✅ **安全特性**：
- 删除前会列出所有文件供确认
- 需要用户手动确认才会执行删除
- 只删除指定前缀的文件
- 详细的进度显示和结果统计

📊 **输出信息**：
- 文件扫描结果
- 文件详细信息（前10个）
- 删除进度和统计
- 成功/失败计数

## 预期结果

清理完成后：
- `package/package/` 文件夹将被完全清空
- 保留正确的文件夹结构：
  - `package/2025-09/`
  - `package/2025-10/`
  - 其他正常的日期文件夹

## 故障排除

### 问题：提示找不到配置文件
**解决方案**：确保 `r2-config.js` 文件存在且配置正确

### 问题：删除失败
**解决方案**：
1. 检查网络连接
2. 验证 R2 访问密钥是否有效
3. 确认是否有删除权限

### 问题：脚本运行报错
**解决方案**：
1. 确保已安装 Node.js
2. 运行 `npm install` 安装依赖
3. 检查 `@aws-sdk/client-s3` 包是否已安装

## 技术细节

- **目标路径**：`package/package/`
- **删除方式**：逐个文件删除
- **批量大小**：每次列出最多 1000 个对象
- **依赖包**：`@aws-sdk/client-s3`

---

💡 **提示**：清理完成后，建议刷新 R2 控制台页面确认文件夹已被删除。

