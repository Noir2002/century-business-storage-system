# 🔧 部署修复指南

## ❌ 部署失败原因
`wrangler.toml` 配置文件中的 `assets` 部分配置错误：
- 使用了过时的 `bucket = "."` 配置
- 缺少必需的 `directory` 属性

## ✅ 已修复的配置
将 `wrangler.toml` 中的：
```toml
[assets]
binding = "ASSETS"
bucket = "."
```

修复为：
```toml
[assets]
directory = "."
binding = "ASSETS"
```

## 🚀 重新部署步骤

### 方法1：自动部署（推荐）
如果您使用的是连接到GitHub的Cloudflare Pages：
1. 提交修改到GitHub仓库
2. Cloudflare Pages会自动触发重新部署
3. 等待部署完成

### 方法2：手动重新运行部署
如果在Cloudflare仪表板中：
1. 访问 Cloudflare 仪表板
2. 进入 Workers & Pages
3. 找到您的项目
4. 点击"Retry deployment"或"Deploy"

### 方法3：本地命令行部署
如果您可以使用命令行：
```bash
# 确保已登录
wrangler login

# 部署
wrangler deploy
```

## 📋 完整的配置文件检查

确保您的 `wrangler.toml` 文件内容如下：
```toml
name = "century-business-system"
main = "worker.js"
compatibility_date = "2025-09-04"

# 自定义域绑定（请填入你自己的 account_id / zone_id / route）
account_id = "23441d4f7734b84186c4c20ddefef8e7"
workers_dev = true

# 静态资源（Workers Sites / Assets）
[assets]
directory = "."
binding = "ASSETS"

# R2存储绑定
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "century-business-system"
```

## 🧪 部署成功验证

部署成功后，您应该能够：
1. 访问Worker URL: `https://century-business-system.您的用户名.workers.dev`
2. 测试健康检查: `https://century-business-system.您的用户名.workers.dev/api/health`
3. 访问静态文件（如果需要）

## ⚠️ 注意事项

1. **Worker名称**: 确保Worker名称为 `century-business-system`
2. **R2绑定**: 确保R2存储桶名称正确
3. **静态资源**: `directory = "."` 表示使用项目根目录作为静态资源目录

## 🔄 下一步

部署成功后：
1. 更新 `api-config.js` 中的Worker URL（如果需要）
2. 测试天猫数据库功能
3. 验证Excel导入功能正常工作

如果仍有问题，请提供最新的错误日志！
