<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂïÜÂìÅÈîÄÈáèÂàÜÊûêÁ≥ªÁªü - Century Business</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <!-- ‰æùËµñÂ∫ì -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- React for Analysis System -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #1e293b;
        }

        #root {
            min-height: 100vh;
            padding: 32px;
        }

        #root * {
            box-sizing: border-box;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // ÂéüÁîü Canvas ÂõæË°®ÁªÑ‰ª∂
        const CanvasLineChart = ({ data, width = 800, height = 300, color = '#3b82f6', label = 'ÈîÄÈáè' }) => {
            const { useRef, useEffect } = React;
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas || !data || data.length === 0) return;
                
                const ctx = canvas.getContext('2d');
                const padding = 60;
                const chartWidth = width - padding * 2;
                const chartHeight = height - padding * 2;
                
                // Ê∏ÖÁ©∫ÁîªÂ∏É
                ctx.clearRect(0, 0, width, height);
                
                // ËÆ°ÁÆóÊï∞ÊçÆËåÉÂõ¥
                const values = data.map(d => d.quantity || d.revenue || 0);
                const maxValue = Math.max(...values, 1);
                const minValue = Math.min(...values, 0);
                const range = maxValue - minValue || 1;
                
                // ÁªòÂà∂ÁΩëÊ†º
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = padding + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(padding, y);
                    ctx.lineTo(width - padding, y);
                    ctx.stroke();
                }
                
                // ÁªòÂà∂ÂùêÊ†áËΩ¥
                ctx.strokeStyle = '#94a3b8';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(padding, padding);
                ctx.lineTo(padding, height - padding);
                ctx.lineTo(width - padding, height - padding);
                ctx.stroke();
                
                // ÁªòÂà∂ÊäòÁ∫øÔºà‰∏çÁªòÂà∂ÁÇπÔºâ
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                data.forEach((item, index) => {
                    const x = padding + (chartWidth / (data.length - 1 || 1)) * index;
                    const value = item.quantity || item.revenue || 0;
                    const y = height - padding - ((value - minValue) / range) * chartHeight;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.stroke();
                
                // ÁªòÂà∂Ê†áÁ≠æ
                ctx.fillStyle = '#64748b';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                data.forEach((item, index) => {
                    const x = padding + (chartWidth / (data.length - 1 || 1)) * index;
                    ctx.fillText(item.date || '', x, height - padding + 20);
                });
                
                // YËΩ¥Ê†áÁ≠æ
                ctx.textAlign = 'right';
                ctx.fillStyle = '#64748b';
                for (let i = 0; i <= 5; i++) {
                    const value = minValue + (range / 5) * (5 - i);
                    const y = padding + (chartHeight / 5) * i;
                    ctx.fillText(Math.round(value).toString(), padding - 10, y + 4);
                }
            }, [data, width, height, color]);
            
            return React.createElement('canvas', { 
                ref: canvasRef, 
                width: width, 
                height: height,
                style: { maxWidth: '100%', height: 'auto' }
            });
        };
        
        const CanvasBarChart = ({ data, width = 800, height = 300, color = '#8b5cf6', label = 'ÈîÄÈáè', horizontal = false }) => {
            const { useRef, useEffect } = React;
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas || !data || data.length === 0) return;
                
                const ctx = canvas.getContext('2d');
                // Ê®™ÂêëÊü±Áä∂ÂõæÈúÄË¶ÅÊõ¥Â§öÂ∑¶‰æßÁ©∫Èó¥Êù•ÊòæÁ§∫Ê†áÈ¢ò
                // Ê†πÊçÆÊï∞ÊçÆ‰∏≠ÊúÄÈïøÊ†áÈ¢òÂä®ÊÄÅËÆ°ÁÆóÂ∑¶‰æßpadding
                let maxLabelLength = 0;
                if (horizontal && data.length > 0) {
                    data.forEach(item => {
                        const label = item.name || '';
                        maxLabelLength = Math.max(maxLabelLength, label.length);
                    });
                }
                const leftPadding = horizontal ? Math.min(Math.max(maxLabelLength * 7 + 20, 250), 400) : 60;
                const rightPadding = 60;
                const topPadding = 60;
                const bottomPadding = 60;
                const padding = horizontal ? leftPadding : 60;
                const chartWidth = width - leftPadding - rightPadding;
                const chartHeight = height - topPadding - bottomPadding;
                
                ctx.clearRect(0, 0, width, height);
                
                const values = data.map(d => d.quantity || 0);
                const maxValue = Math.max(...values, 1);
                const barWidth = horizontal ? chartHeight / data.length : chartWidth / data.length;
                const barSpacing = barWidth * 0.2;
                const actualBarWidth = barWidth - barSpacing;
                
                // ÁªòÂà∂ÁΩëÊ†º
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    if (horizontal) {
                        const x = leftPadding + (chartWidth / 5) * i;
                        ctx.beginPath();
                        ctx.moveTo(x, topPadding);
                        ctx.lineTo(x, height - bottomPadding);
                        ctx.stroke();
                    } else {
                        const y = padding + (chartHeight / 5) * i;
                        ctx.beginPath();
                        ctx.moveTo(padding, y);
                        ctx.lineTo(width - padding, y);
                        ctx.stroke();
                    }
                }
                
                // ÁªòÂà∂ÂùêÊ†áËΩ¥
                ctx.strokeStyle = '#94a3b8';
                ctx.lineWidth = 2;
                ctx.beginPath();
                if (horizontal) {
                    ctx.moveTo(leftPadding, topPadding);
                    ctx.lineTo(leftPadding, height - bottomPadding);
                    ctx.lineTo(width - rightPadding, height - bottomPadding);
                } else {
                    ctx.moveTo(padding, padding);
                    ctx.lineTo(padding, height - padding);
                    ctx.lineTo(width - padding, height - padding);
                }
                ctx.stroke();
                
                // ÁªòÂà∂Êü±Áä∂Âõæ
                data.forEach((item, index) => {
                    const value = item.quantity || 0;
                    const barHeight = (value / maxValue) * chartHeight;
                    
                    if (horizontal) {
                        const y = topPadding + barWidth * index + barSpacing / 2;
                        const barLength = (value / maxValue) * chartWidth;
                        
                        ctx.fillStyle = color;
                        ctx.fillRect(leftPadding, y, barLength, actualBarWidth);
                        
                        // Ê†áÁ≠æ - ÊòæÁ§∫ÂÆåÊï¥Ê†áÈ¢òÔºå‰∏çÊà™Êñ≠
                        ctx.fillStyle = '#64748b';
                        ctx.font = '12px sans-serif';
                        ctx.textAlign = 'right';
                        const label = item.name || '';
                        // ËÆ°ÁÆóÂèØÊòæÁ§∫ÁöÑÊúÄÂ§ßÂ≠óÁ¨¶Êï∞ÔºàÊ†πÊçÆÂ∑¶‰æßpaddingÔºâ
                        const maxChars = Math.floor((leftPadding - 20) / 7);
                        let displayLabel = label;
                        if (label.length > maxChars) {
                            displayLabel = label.substring(0, maxChars - 3) + '...';
                        }
                        ctx.fillText(displayLabel, leftPadding - 10, y + actualBarWidth / 2 + 4);
                    } else {
                        const x = padding + barWidth * index + barSpacing / 2;
                        
                        ctx.fillStyle = color;
                        ctx.fillRect(x, height - padding - barHeight, actualBarWidth, barHeight);
                        
                        // Ê†áÁ≠æ
                        ctx.fillStyle = '#94a3b8';
                        ctx.font = '12px sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText(item.name || '', x + actualBarWidth / 2, height - padding + 20);
                    }
                });
                
                // YËΩ¥Ê†áÁ≠æ
                ctx.fillStyle = '#94a3b8';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'right';
                for (let i = 0; i <= 5; i++) {
                    const value = (maxValue / 5) * (5 - i);
                    if (horizontal) {
                        const x = leftPadding + (chartWidth / 5) * i;
                        ctx.fillText(Math.round(value).toString(), x - 10, height - bottomPadding + 4);
                    } else {
                        const y = padding + (chartHeight / 5) * i;
                        ctx.fillText(Math.round(value).toString(), padding - 10, y + 4);
                    }
                }
            }, [data, width, height, color, horizontal]);
            
            return React.createElement('canvas', { 
                ref: canvasRef, 
                width: width, 
                height: height,
                style: { maxWidth: '100%', height: 'auto' }
            });
        };

        // È•ºÁä∂ÂõæÁªÑ‰ª∂
        const CanvasPieChart = ({ data, width = 600, height = 400, showRevenue = false }) => {
            const { useRef, useEffect } = React;
            const canvasRef = useRef(null);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas || !data || data.length === 0) return;
                
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, width, height);
                
                // ËÆ°ÁÆóÊÄªÂíå - Ê†πÊçÆshowRevenueÂÜ≥ÂÆö‰ΩøÁî®Êï∞ÈáèËøòÊòØÈîÄÂîÆÈ¢ù
                const total = data.reduce((sum, item) => sum + (showRevenue ? (item.revenue || 0) : (item.quantity || 0)), 0);
                if (total === 0) return;
                
                // È•ºÂõæ‰∏≠ÂøÉ‰ΩçÁΩÆÂíåÂçäÂæÑ - ‰∏∫Âõæ‰æãÁïôÂá∫Êõ¥Â§öÁ©∫Èó¥
                const centerX = width / 2;
                const centerY = height / 2 - 40;
                const radius = Math.min(width, height) / 2 - 120;
                
                // È¢úËâ≤Êï∞ÁªÑ
                const colors = [
                    '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6',
                    '#ec4899', '#06b6d4', '#84cc16', '#f97316', '#6366f1',
                    '#14b8a6', '#a855f7', '#f43f5e', '#0ea5e9', '#22c55e'
                ];
                
                let currentAngle = -Math.PI / 2; // ‰ªéÈ°∂ÈÉ®ÂºÄÂßã
                
                // ÁªòÂà∂È•ºÂõæ
                data.forEach((item, index) => {
                    const value = showRevenue ? (item.revenue || 0) : (item.quantity || 0);
                    const sliceAngle = (value / total) * 2 * Math.PI;
                    
                    // ÁªòÂà∂ÊâáÂΩ¢
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = colors[index % colors.length];
                    ctx.fill();
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // ÁªòÂà∂Ê†áÁ≠æÂíåÊï∞ÂÄº
                    const labelAngle = currentAngle + sliceAngle / 2;
                    const labelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
                    const labelY = centerY + Math.sin(labelAngle) * (radius * 0.7);
                    
                    // Â¶ÇÊûúÊâáÂΩ¢Ë∂≥Â§üÂ§ßÔºåÂú®ÂÜÖÈÉ®ÊòæÁ§∫ÁôæÂàÜÊØî
                    if (sliceAngle > 0.1) {
                        ctx.fillStyle = '#ffffff';
                        ctx.font = 'bold 12px sans-serif';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        const percentage = ((value / total) * 100).toFixed(1);
                        ctx.fillText(percentage + '%', labelX, labelY);
                    }
                    
                    // ÁªòÂà∂Âõæ‰æã - ÂàÜ‰∏§ÂàóÊòæÁ§∫
                    const itemsPerColumn = Math.ceil(data.length / 2);
                    const columnIndex = index < itemsPerColumn ? 0 : 1;
                    const rowIndex = index < itemsPerColumn ? index : index - itemsPerColumn;
                    
                    const legendX = columnIndex === 0 ? 50 : width / 2 + 20;
                    const legendY = 60 + rowIndex * 25;
                    const legendColor = colors[index % colors.length];
                    
                    // Âõæ‰æãÈ¢úËâ≤Âùó
                    ctx.fillStyle = legendColor;
                    ctx.fillRect(legendX, legendY - 8, 12, 12);
                    ctx.strokeStyle = '#e2e8f0';
                    ctx.lineWidth = 1;
                    ctx.strokeRect(legendX, legendY - 8, 12, 12);
                    
                    // Âõæ‰æãÊñáÂ≠ó - Ê†πÊçÆshowRevenueÊòæÁ§∫‰∏çÂêåÊ†ºÂºè
                    ctx.fillStyle = '#1e293b';
                    ctx.font = '12px sans-serif';
                    ctx.textAlign = 'left';
                    ctx.textBaseline = 'middle';
                    const label = item.name || '';
                    let displayText = '';
                    if (showRevenue) {
                        // ÊòæÁ§∫ÂìÅÁâåÂíåÈîÄÂîÆÈ¢ù
                        displayText = `${label} (‚Ç¨${value.toFixed(2)})`;
                    } else {
                        // ÊòæÁ§∫Â∞∫Á†Å/È¢úËâ≤ÂíåÊï∞Èáè
                        displayText = `${label} (${value})`;
                    }
                    ctx.fillText(displayText, legendX + 18, legendY);
                    
                    currentAngle += sliceAngle;
                });
            }, [data, width, height, showRevenue]);
            
            return React.createElement('canvas', { 
                ref: canvasRef, 
                width: width, 
                height: height,
                style: { maxWidth: '100%', height: 'auto' }
            });
        };

        // ÂàÜÊûêÁ≥ªÁªüReactÁªÑ‰ª∂
        const { useState, useMemo } = React;

        // È¢úËâ≤‰ª£Á†ÅÊò†Â∞ÑË°®
        const COLOR_MAP = {
            'BLK': 'ÈªëËâ≤', 'WHT': 'ÁôΩËâ≤', 'RED': 'Á∫¢Ëâ≤', 'BLU': 'ËìùËâ≤', 'GRN': 'ÁªøËâ≤',
            'YEL': 'ÈªÑËâ≤', 'ORG': 'Ê©ôËâ≤', 'PNK': 'Á≤âËâ≤', 'PUR': 'Á¥´Ëâ≤', 'GRY': 'ÁÅ∞Ëâ≤',
            'BRN': 'Ê£ïËâ≤', 'BGE': 'Á±≥Ëâ≤', 'NVY': 'ËóèÈùí', 'GLD': 'ÈáëËâ≤', 'SLV': 'Èì∂Ëâ≤',
            'BBLC': 'ÈªëËìù', 'WGRY': 'ÁôΩÁÅ∞', 'RBLK': 'Á∫¢Èªë', 'BWHT': 'ËìùÁôΩ', 'GBLK': 'ÁªøÈªë'
        };

        // ‰∏çÂÜçÈúÄË¶Å RechartsÔºå‰ΩøÁî®ÂéüÁîü Canvas ÁªÑ‰ª∂

        const SalesAnalysisSystem = () => {
            console.log('SalesAnalysisSystem ÁªÑ‰ª∂ÂºÄÂßãÊ∏≤Êüì - ‰ΩøÁî®ÂéüÁîü Canvas ÁâàÊú¨');
            
            const [data, setData] = useState([]);
            const [filters, setFilters] = useState({
                style: '',
                brand: '',
                color: '',
                size: '',
                startDate: '',
                endDate: '',
                timeGranularity: 'day'
            });
            const [showFilters, setShowFilters] = useState(false);
            const [uploadStatus, setUploadStatus] = useState({ type: 'idle', message: '' }); // idle, loading, success, error

            // Ëß£ÊûêSKUËé∑ÂèñÈ¢úËâ≤
            const parseColor = (sku) => {
                if (!sku) return 'Êú™Áü•';
                const parts = sku.split('-');
                if (parts.length >= 2) {
                    const colorCode = parts[1].toUpperCase();
                    return COLOR_MAP[colorCode] || colorCode;
                }
                return 'Êú™Áü•';
            };

            // Â§ÑÁêÜÊñá‰ª∂‰∏ä‰º†
            const handleFileUpload = (e) => {
                console.log('Êñá‰ª∂‰∏ä‰º†‰∫ã‰ª∂Ëß¶Âèë');
                const file = e.target.files[0];
                if (!file) {
                    console.warn('Ê≤°ÊúâÈÄâÊã©Êñá‰ª∂');
                    setUploadStatus({ type: 'error', message: 'Êú™ÈÄâÊã©Êñá‰ª∂' });
                    return;
                }

                console.log('ÈÄâÊã©ÁöÑÊñá‰ª∂:', file.name, file.size, 'bytes');
                setUploadStatus({ type: 'loading', message: `Ê≠£Âú®ËØªÂèñÊñá‰ª∂: ${file.name}...` });
                
                // Ê£ÄÊü• XLSX Â∫ìÊòØÂê¶Âä†ËΩΩ
                if (typeof XLSX === 'undefined') {
                    const errorMsg = 'Excel Ëß£ÊûêÂ∫ìÊú™Âä†ËΩΩÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï';
                    setUploadStatus({ type: 'error', message: errorMsg });
                    console.error('XLSX Â∫ìÊú™ÂÆö‰πâ');
                    setTimeout(() => setUploadStatus({ type: 'idle', message: '' }), 5000);
                    return;
                }

                const reader = new FileReader();
                
                reader.onerror = (error) => {
                    console.error('Êñá‰ª∂ËØªÂèñÈîôËØØ:', error);
                    const errorMsg = 'Êñá‰ª∂ËØªÂèñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï';
                    setUploadStatus({ type: 'error', message: errorMsg });
                    setTimeout(() => setUploadStatus({ type: 'idle', message: '' }), 5000);
                };
                
                reader.onprogress = (event) => {
                    if (event.lengthComputable) {
                        const percent = Math.round((event.loaded / event.total) * 100);
                        setUploadStatus({ type: 'loading', message: `Ê≠£Âú®ËØªÂèñÊñá‰ª∂: ${percent}%` });
                    }
                };
                
                reader.onload = (event) => {
                    console.log('Êñá‰ª∂ËØªÂèñÂÆåÊàêÔºåÂºÄÂßãËß£Êûê...');
                    setUploadStatus({ type: 'loading', message: 'Ê≠£Âú®Ëß£Êûê Excel Êñá‰ª∂...' });
                    
                    try {
                        console.log('Ê£ÄÊü• XLSX:', typeof XLSX);
                        const workbook = XLSX.read(event.target.result, { type: 'binary' });
                        console.log('Â∑•‰ΩúÁ∞øËØªÂèñÊàêÂäüÔºåÂ∑•‰ΩúË°®Êï∞Èáè:', workbook.SheetNames.length);
                        
                        setUploadStatus({ type: 'loading', message: 'Ê≠£Âú®Â§ÑÁêÜÊï∞ÊçÆ...' });
                        
                        const sheetName = workbook.SheetNames[0];
                        const sheet = workbook.Sheets[sheetName];
                        const rawData = XLSX.utils.sheet_to_json(sheet);
                        console.log('ÂéüÂßãÊï∞ÊçÆË°åÊï∞:', rawData.length);
                        console.log('Á¨¨‰∏ÄË°åÊï∞ÊçÆÁ§∫‰æã:', rawData[0]);

                        const processedData = rawData.map((row, index) => {
                            // Ëé∑ÂèñÂïÜÂìÅÂêçÁß∞ - ‰ºòÂÖàÂåπÈÖçÂÆûÈôÖÂàóÂêç
                            const getName = () => {
                                return row['ÂïÜÂìÅÂêçÁß∞'] || row['Ê†áÈ¢ò'] || row['ÂêçÁß∞'] || row['product_name'] || row['name'] || row['ÂïÜÂìÅÂêç'] || row['title'] || '';
                            };
                            // Ëé∑ÂèñÂìÅÁâåÂêçÁß∞
                            const getBrand = () => {
                                return row['ÂìÅÁâåÂêçÁß∞'] || row['ÂìÅÁâå'] || row['brand'] || row['brand_name'] || '';
                            };
                            // Ëé∑ÂèñSKU
                            const getSKU = () => {
                                return row['SKU'] || row['sku'] || row['ÂïÜÂìÅÁºñÁ†Å'] || row['ÁºñÁ†Å'] || '';
                            };
                            // Ëé∑ÂèñÂ∞∫Á†Å - Áªü‰∏ÄÊ†ºÂºèÂåñ‰∏∫1‰ΩçÂ∞èÊï∞
                            const getSize = () => {
                                const sizeValue = row['Â∞∫Á†Å'] || row['size'] || row['ËßÑÊ†º'] || '';
                                if (!sizeValue) return '';
                                
                                // Â∞ùËØïËΩ¨Êç¢‰∏∫Êï∞Â≠óÔºåÂ¶ÇÊûúÊòØÊï∞Â≠óÂàô‰øùÁïô1‰ΩçÂ∞èÊï∞
                                const numSize = parseFloat(sizeValue);
                                if (!isNaN(numSize)) {
                                    return numSize.toFixed(1);
                                }
                                // Â¶ÇÊûú‰∏çÊòØÊï∞Â≠óÔºåÁõ¥Êé•ËøîÂõûÂéüÂÄº
                                return String(sizeValue);
                            };
                            // Ëé∑ÂèñÊï∞Èáè - ‰ºòÂÖàÂåπÈÖç"ÂïÜÂìÅÊï∞Èáè"
                            const getQuantity = () => {
                                const qty = row['ÂïÜÂìÅÊï∞Èáè'] || row['Êï∞Èáè'] || row['quantity'] || row['ÈîÄÈáè'] || row['ÈîÄÂîÆÊï∞Èáè'] || 0;
                                return parseInt(qty) || 0;
                            };
                            // Ëé∑Âèñ‰ª∑Ê†º - ‰ºòÂÖàÂåπÈÖç"ËÆ¢ÂçïÈáëÈ¢ù"
                            const getPrice = () => {
                                const price = row['ËÆ¢ÂçïÈáëÈ¢ù'] || row['ÈáëÈ¢ù'] || row['price'] || row['Âçï‰ª∑'] || row['ÂïÜÂìÅÂçï‰ª∑'] || 0;
                                return parseFloat(price) || 0;
                            };
                            // Ëé∑ÂèñÊó•Êúü - ÊîØÊåÅExcelÊó•ÊúüÊ†ºÂºè
                            const getDate = () => {
                                let dateStr = row['Â∫óÈì∫ËÆ¢ÂçïÊó∂Èó¥'] || row['ËÆ¢ÂçïÊó∂Èó¥'] || row['date'] || row['Êó∂Èó¥'] || row['Êó•Êúü'] || '';
                                
                                // Â¶ÇÊûúÊòØExcelÊó•ÊúüÊï∞Â≠óÊ†ºÂºèÔºàÂ¶Ç 45965.5260532407Ôºâ
                                if (typeof dateStr === 'number') {
                                    // ExcelÊó•Êúü‰ªé1900Âπ¥1Êúà1Êó•ÂºÄÂßãËÆ°ÁÆó
                                    const excelEpoch = new Date(1899, 11, 30);
                                    const date = new Date(excelEpoch.getTime() + dateStr * 24 * 60 * 60 * 1000);
                                    if (!isNaN(date.getTime())) {
                                        return date;
                                    }
                                }
                                
                                if (dateStr) {
                                    // Â∞ùËØïËß£ÊûêÊó•ÊúüÂ≠óÁ¨¶‰∏≤
                                    const date = new Date(dateStr);
                                    if (isNaN(date.getTime())) {
                                        console.warn('Êó•ÊúüËß£ÊûêÂ§±Ë¥•:', dateStr, '‰ΩøÁî®ÂΩìÂâçÊó•Êúü');
                                        return new Date();
                                    }
                                    return date;
                                }
                                return new Date();
                            };

                            const name = getName();
                            const brand = getBrand();
                            const sku = getSKU();
                            const quantity = getQuantity();
                            
                            return {
                                style: name,
                                brand: brand,
                                sku: sku,
                                color: parseColor(sku),
                                size: String(getSize()),
                                quantity: quantity,
                                price: getPrice(),
                                date: getDate(),
                                revenue: quantity * getPrice()
                            };
                        }).filter(item => {
                            // Âè™Ë¶ÅÊúâÂïÜÂìÅÂêçÁß∞ÔºàÊ†áÈ¢òÔºâÂíåÊï∞ÈáèÂ§ß‰∫é0Â∞±‰øùÁïô
                            const valid = item.style && item.quantity > 0;
                            if (!valid) {
                                console.warn('ËøáÊª§ÊéâÊó†ÊïàÊï∞ÊçÆ:', item);
                            }
                            return valid;
                        });

                        console.log('Â§ÑÁêÜÂêéÁöÑÊï∞ÊçÆË°åÊï∞:', processedData.length);
                        if (processedData.length === 0) {
                            const errorMsg = `Êñá‰ª∂‰∏≠Ê≤°ÊúâÊúâÊïàÊï∞ÊçÆ„ÄÇ\n\nÈúÄË¶ÅÁöÑÂàóÔºöÂïÜÂìÅÂêçÁß∞„ÄÅÊï∞ÈáèÔºàÊàñÈîÄÈáèÔºâ\n\nÂÆûÈôÖÂàóÂêçÔºö${rawData.length > 0 ? Object.keys(rawData[0]).join(', ') : 'Êó†Êï∞ÊçÆ'}`;
                            setUploadStatus({ type: 'error', message: errorMsg });
                            console.log('ÂéüÂßãÊï∞ÊçÆÂàóÂêç:', rawData.length > 0 ? Object.keys(rawData[0]) : 'Êó†Êï∞ÊçÆ');
                            setTimeout(() => setUploadStatus({ type: 'idle', message: '' }), 8000);
                            return;
                        }

                        console.log('ËÆæÁΩÆÊï∞ÊçÆÂà∞Áä∂ÊÄÅ...');
                        setData(processedData);
                        setUploadStatus({ type: 'success', message: `ÊàêÂäüÂä†ËΩΩ ${processedData.length} Êù°Êï∞ÊçÆÔºÅ` });
                        console.log('Êï∞ÊçÆËÆæÁΩÆÂÆåÊàêÔºåÊï∞ÊçÆË°åÊï∞:', processedData.length);
                        
                        // 3ÁßíÂêéÊ∏ÖÈô§ÊàêÂäüÊ∂àÊÅØ
                        setTimeout(() => setUploadStatus({ type: 'idle', message: '' }), 3000);
                    } catch (error) {
                        console.error('Êñá‰ª∂Ëß£ÊûêÈîôËØØ:', error);
                        console.error('ÈîôËØØÂ†ÜÊ†à:', error.stack);
                        const errorMsg = `Êñá‰ª∂Ëß£ÊûêÂ§±Ë¥•Ôºö${error.message}`;
                        setUploadStatus({ type: 'error', message: errorMsg });
                        setTimeout(() => setUploadStatus({ type: 'idle', message: '' }), 8000);
                    }
                };
                
                console.log('ÂºÄÂßãËØªÂèñÊñá‰ª∂...');
                reader.readAsBinaryString(file);
            };

            // Ëé∑ÂèñÁ≠õÈÄâÈÄâÈ°π
            const filterOptions = useMemo(() => {
                if (!data || data.length === 0) {
                    return {
                        styles: [],
                        brands: [],
                        colors: [],
                        sizes: []
                    };
                }
                return {
                    styles: [...new Set(data.map(d => d.style).filter(s => s))].sort(),
                    brands: [...new Set(data.map(d => d.brand).filter(b => b))].sort(),
                    colors: [...new Set(data.map(d => d.color).filter(c => c))].sort(),
                    sizes: [...new Set(data.map(d => d.size).filter(s => s))].sort()
                };
            }, [data]);

            // Â∫îÁî®Á≠õÈÄâ
            const filteredData = useMemo(() => {
                return data.filter(item => {
                    if (filters.style && item.style !== filters.style) return false;
                    if (filters.brand && item.brand !== filters.brand) return false;
                    if (filters.color && item.color !== filters.color) return false;
                    if (filters.size && item.size !== filters.size) return false;
                    if (filters.startDate && item.date < new Date(filters.startDate)) return false;
                    if (filters.endDate && item.date > new Date(filters.endDate)) return false;
                    return true;
                });
            }, [data, filters]);

            // Ê†ºÂºèÂåñÊó•Êúü
            const formatDate = (date, granularity) => {
                const d = new Date(date);
                if (granularity === 'day') {
                    return `${d.getMonth() + 1}/${d.getDate()}`;
                } else if (granularity === 'week') {
                    const weekNum = Math.ceil((d.getDate()) / 7);
                    return `${d.getMonth() + 1}ÊúàÁ¨¨${weekNum}Âë®`;
                } else {
                    return `${d.getFullYear()}/${d.getMonth() + 1}`;
                }
            };

            // ËÆ°ÁÆóÊó∂Èó¥Ë∂ãÂäøÊï∞ÊçÆ
            const trendData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    const key = formatDate(item.date, filters.timeGranularity);
                    if (!grouped[key]) {
                        grouped[key] = { date: key, quantity: 0, revenue: 0 };
                    }
                    grouped[key].quantity += item.quantity;
                    grouped[key].revenue += item.revenue;
                });
                return Object.values(grouped).sort((a, b) => {
                    const aDate = a.date.split(/[/ÊúàÂë®Âπ¥]/);
                    const bDate = b.date.split(/[/ÊúàÂë®Âπ¥]/);
                    return aDate[0] - bDate[0] || (aDate[1] || 0) - (bDate[1] || 0);
                });
            }, [filteredData, filters.timeGranularity]);

            // ÊåâÊ¨æÂºèÁªüËÆ°
            const styleData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.style]) {
                        grouped[item.style] = { name: item.style, quantity: 0, revenue: 0 };
                    }
                    grouped[item.style].quantity += item.quantity;
                    grouped[item.style].revenue += item.revenue;
                });
                return Object.values(grouped).sort((a, b) => b.quantity - a.quantity).slice(0, 10);
            }, [filteredData]);

            // ÊåâÈ¢úËâ≤ÁªüËÆ°
            const colorData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.color]) {
                        grouped[item.color] = { name: item.color, quantity: 0 };
                    }
                    grouped[item.color].quantity += item.quantity;
                });
                return Object.values(grouped).sort((a, b) => b.quantity - a.quantity);
            }, [filteredData]);

            // ÊåâÂ∞∫Á†ÅÁªüËÆ°
            const sizeData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.size]) {
                        grouped[item.size] = { name: item.size, quantity: 0 };
                    }
                    grouped[item.size].quantity += item.quantity;
                });
                return Object.values(grouped).sort((a, b) => {
                    const aNum = parseFloat(a.name) || 0;
                    const bNum = parseFloat(b.name) || 0;
                    return aNum - bNum;
                });
            }, [filteredData]);

            // ÊåâÂìÅÁâåÁªüËÆ°ÔºàÁî®‰∫éÈ•ºÁä∂ÂõæÔºåÊòæÁ§∫ÈîÄÂîÆÈ¢ùÔºâ
            const brandData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!item.brand) return; // Ë∑≥ËøáÊ≤°ÊúâÂìÅÁâåÁöÑÊï∞ÊçÆ
                    if (!grouped[item.brand]) {
                        grouped[item.brand] = { name: item.brand, quantity: 0, revenue: 0 };
                    }
                    grouped[item.brand].quantity += item.quantity;
                    grouped[item.brand].revenue += item.revenue;
                });
                return Object.values(grouped).sort((a, b) => b.revenue - a.revenue);
            }, [filteredData]);

            // ËÆ°ÁÆóÁªüËÆ°Êï∞ÊçÆ
            const stats = useMemo(() => {
                const totalQuantity = filteredData.reduce((sum, item) => sum + item.quantity, 0);
                const totalRevenue = filteredData.reduce((sum, item) => sum + item.revenue, 0);
                const avgPrice = totalQuantity > 0 ? totalRevenue / totalQuantity : 0;
                
                let daysDiff = 1;
                
                // Â¶ÇÊûúÁ≠õÈÄâÂô®‰∏≠ËÆæÁΩÆ‰∫ÜÂºÄÂßãÊó•ÊúüÂíåÁªìÊùüÊó•ÊúüÔºå‰ΩøÁî®Á≠õÈÄâÊó•ÊúüËåÉÂõ¥
                if (filters.startDate && filters.endDate) {
                    const startDate = new Date(filters.startDate);
                    const endDate = new Date(filters.endDate);
                    daysDiff = (endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24) + 1;
                } else {
                    // ÈªòËÆ§ÊÉÖÂÜµÔºö‰ΩøÁî®ÂÆûÈôÖÊï∞ÊçÆÁöÑÊó•ÊúüËåÉÂõ¥ÔºàÊñπÊ°à‰∫åÔºâ
                    const dates = filteredData.map(d => d.date.getTime());
                    if (dates.length > 0) {
                        daysDiff = (Math.max(...dates) - Math.min(...dates)) / (1000 * 60 * 60 * 24) + 1;
                    }
                }
                
                const velocity = totalQuantity / daysDiff;

                return {
                    totalQuantity,
                    totalRevenue,
                    avgPrice,
                    velocity,
                    orderCount: filteredData.length
                };
            }, [filteredData, filters.startDate, filters.endDate]);

            // ÂØºÂá∫PDF
            const exportPDF = async () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                
                pdf.setFontSize(20);
                pdf.text('ÈîÄÈáèÂàÜÊûêÊä•Âëä', pageWidth / 2, 20, { align: 'center' });
                
                pdf.setFontSize(12);
                let yPos = 35;
                pdf.text(`ÊÄªÈîÄÈáè: ${stats.totalQuantity} ‰ª∂`, 20, yPos);
                pdf.text(`ÊÄªÈîÄÂîÆÈ¢ù: ‚Ç¨${stats.totalRevenue.toFixed(2)}`, 20, yPos + 7);
                pdf.text(`Âπ≥ÂùáÂçï‰ª∑: ‚Ç¨${stats.avgPrice.toFixed(2)}`, 20, yPos + 14);
                pdf.text(`ÈîÄÂîÆÊµÅÈÄü: ${stats.velocity.toFixed(2)} ‰ª∂/Â§©`, 20, yPos + 21);
                
                const charts = document.querySelectorAll('.chart-container');
                yPos = 70;
                
                for (let i = 0; i < charts.length; i++) {
                    if (yPos > 250) {
                        pdf.addPage();
                        yPos = 20;
                    }
                    
                    try {
                        const canvas = await html2canvas(charts[i], { scale: 2 });
                        const imgData = canvas.toDataURL('image/png');
                        const imgWidth = pageWidth - 40;
                        const imgHeight = (canvas.height * imgWidth) / canvas.width;
                        
                        pdf.addImage(imgData, 'PNG', 20, yPos, imgWidth, imgHeight);
                        yPos += imgHeight + 10;
                    } catch (error) {
                        console.error('ÂõæË°®ÂØºÂá∫Â§±Ë¥•:', error);
                    }
                }
                
                pdf.save(`ÈîÄÈáèÂàÜÊûêÊä•Âëä_${new Date().toLocaleDateString()}.pdf`);
            };

            // ÂàõÂª∫ÂõæÊ†áÁªÑ‰ª∂ÔºàÁÆÄÂåñÁâàÔºå‰ΩøÁî®SVGÔºâ
            const UploadIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4' }),
                React.createElement('polyline', { points: '17 8 12 3 7 8' }),
                React.createElement('line', { x1: 12, y1: 3, x2: 12, y2: 15 })
            );

            const FilterIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('polygon', { points: '22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3' })
            );

            const DownloadIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4' }),
                React.createElement('polyline', { points: '7 10 12 15 17 10' }),
                React.createElement('line', { x1: 12, y1: 15, x2: 12, y2: 3 })
            );

            const XIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 18, y1: 6, x2: 6, y2: 18 }),
                React.createElement('line', { x1: 6, y1: 6, x2: 18, y2: 18 })
            );

            const PackageIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 16.5, y1: 9.4, x2: 7.5, y2: 4.21 }),
                React.createElement('path', { d: 'M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z' }),
                React.createElement('polyline', { points: '3.27 6.96 12 12.01 20.73 6.96' }),
                React.createElement('line', { x1: 12, y1: 22.08, x2: 12, y2: 12 })
            );

            const DollarSignIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 12, y1: 1, x2: 12, y2: 23 }),
                React.createElement('path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6' })
            );

            const TrendingUpIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('polyline', { points: '23 6 13.5 15.5 8.5 10.5 1 18' }),
                React.createElement('polyline', { points: '17 6 23 6 23 12' })
            );

            const CalendarIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('rect', { x: 3, y: 4, width: 18, height: 18, rx: 2, ry: 2 }),
                React.createElement('line', { x1: 16, y1: 2, x2: 16, y2: 6 }),
                React.createElement('line', { x1: 8, y1: 2, x2: 8, y2: 6 }),
                React.createElement('line', { x1: 3, y1: 10, x2: 21, y2: 10 })
            );

            return React.createElement('div', { 
                style: { 
                    minHeight: '100vh', 
                    background: '#ffffff', 
                    color: '#1e293b', 
                    padding: '32px' 
                } 
            },
                React.createElement('div', { style: { maxWidth: '1280px', margin: '0 auto' } },
                    // Â§¥ÈÉ®
                    React.createElement('div', { style: { marginBottom: '32px' } },
                        React.createElement('h1', { 
                            style: { 
                                fontSize: '2.25rem', 
                                fontWeight: 'bold', 
                                marginBottom: '8px',
                                color: '#1e293b'
                            } 
                        }, 'ÂïÜÂìÅÈîÄÈáèÂàÜÊûêÁ≥ªÁªü'),
                        React.createElement('p', { style: { color: '#64748b' } }, 'Êï∞ÊçÆÈ©±Âä®ÂÜ≥Á≠ñÔºåÊ¥ûÂØüÈîÄÂîÆË∂ãÂäø')
                    ),

                    // ‰∏ä‰º†Áä∂ÊÄÅÊèêÁ§∫
                    uploadStatus.type !== 'idle' && React.createElement('div', {
                        style: {
                            marginBottom: '24px',
                            padding: '16px 24px',
                            borderRadius: '12px',
                            backdropFilter: 'blur(16px)',
                            background: uploadStatus.type === 'error' 
                                ? 'rgba(239, 68, 68, 0.2)' 
                                : uploadStatus.type === 'success'
                                ? 'rgba(16, 185, 129, 0.2)'
                                : 'rgba(59, 130, 246, 0.2)',
                            border: `1px solid ${uploadStatus.type === 'error' 
                                ? 'rgba(239, 68, 68, 0.5)' 
                                : uploadStatus.type === 'success'
                                ? 'rgba(16, 185, 129, 0.5)'
                                : 'rgba(59, 130, 246, 0.5)'}`,
                            display: 'flex',
                            alignItems: 'center',
                            gap: '12px',
                            color: uploadStatus.type === 'error' ? '#dc2626' : uploadStatus.type === 'success' ? '#059669' : '#1e40af'
                        }
                    },
                        uploadStatus.type === 'loading' && React.createElement('div', {
                            style: {
                                width: '20px',
                                height: '20px',
                                border: '3px solid rgba(255, 255, 255, 0.3)',
                                borderTop: '3px solid white',
                                borderRadius: '50%',
                                animation: 'spin 1s linear infinite'
                            }
                        }),
                        uploadStatus.type === 'error' && React.createElement('span', { style: { fontSize: '20px' } }, '‚ùå'),
                        uploadStatus.type === 'success' && React.createElement('span', { style: { fontSize: '20px' } }, '‚úÖ'),
                        React.createElement('div', { style: { flex: 1 } },
                            React.createElement('p', { 
                                style: { 
                                    margin: 0, 
                                    fontWeight: uploadStatus.type === 'error' ? '600' : '500',
                                    whiteSpace: 'pre-line'
                                } 
                            }, uploadStatus.message)
                        )
                    ),

                    // ‰∏ä‰º†Âå∫Âüü
                    data.length === 0 && React.createElement('div', { 
                        style: { 
                            backdropFilter: 'blur(16px)', 
                            background: 'rgba(255, 255, 255, 0.9)', 
                            borderRadius: '16px', 
                            border: '1px solid rgba(0, 0, 0, 0.1)', 
                            padding: '48px', 
                            textAlign: 'center', 
                            marginBottom: '32px',
                            transition: 'all 0.3s'
                        } 
                    },
                        React.createElement(UploadIcon),
                        React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginTop: '16px', marginBottom: '8px' } }, '‰∏ä‰º†ExcelÊñá‰ª∂'),
                        React.createElement('p', { style: { color: '#64748b', marginBottom: '16px' } }, 'ÊîØÊåÅ .xlsx, .xls Ê†ºÂºè'),
                        React.createElement('label', { style: { display: 'inline-block', cursor: 'pointer' } },
                            React.createElement('input', { 
                                type: 'file', 
                                accept: '.xlsx,.xls', 
                                onChange: handleFileUpload, 
                                style: { display: 'none' } 
                            }),
                            React.createElement('span', { 
                                style: { 
                                    display: 'inline-block',
                                    padding: '12px 24px', 
                                    background: 'linear-gradient(to right, #3b82f6, #8b5cf6)', 
                                    borderRadius: '8px', 
                                    fontWeight: '600',
                                    transition: 'all 0.3s'
                                } 
                            }, 'ÈÄâÊã©Êñá‰ª∂')
                        )
                    ),

                    // Êï∞ÊçÆÂ±ïÁ§∫Âå∫
                    data.length > 0 && React.createElement(React.Fragment, null,
                        // Êìç‰ΩúÊ†è
                        React.createElement('div', { style: { display: 'flex', gap: '16px', marginBottom: '24px' } },
                            React.createElement('button', {
                                onClick: () => setShowFilters(!showFilters),
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    backdropFilter: 'blur(16px)',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: '1px solid rgba(255, 255, 255, 0.2)',
                                    color: '#1e293b',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            }, React.createElement(FilterIcon), 'Á≠õÈÄâÂô®'),
                            React.createElement('button', {
                                onClick: exportPDF,
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    background: 'linear-gradient(to right, #10b981, #059669)',
                                    borderRadius: '8px',
                                    color: '#1e293b',
                                    border: 'none',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            }, React.createElement(DownloadIcon), 'ÂØºÂá∫PDF'),
                            React.createElement('label', {
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    backdropFilter: 'blur(16px)',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: '1px solid rgba(255, 255, 255, 0.2)',
                                    color: '#1e293b',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            },
                                React.createElement(UploadIcon),
                                'ÈáçÊñ∞‰∏ä‰º†',
                                React.createElement('input', { 
                                    type: 'file', 
                                    accept: '.xlsx,.xls', 
                                    onChange: handleFileUpload, 
                                    style: { display: 'none' } 
                                })
                            )
                        ),

                        // Á≠õÈÄâÈù¢Êùø
                        showFilters && React.createElement('div', { 
                            style: { 
                                backdropFilter: 'blur(16px)', 
                                background: 'rgba(255, 255, 255, 0.1)', 
                                borderRadius: '16px', 
                                border: '1px solid rgba(255, 255, 255, 0.2)', 
                                padding: '24px', 
                                marginBottom: '24px' 
                            } 
                        },
                            React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' } },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600' } }, 'Á≠õÈÄâÊù°‰ª∂'),
                                React.createElement('button', {
                                    onClick: () => setShowFilters(false),
                                    style: {
                                        background: 'transparent',
                                        border: 'none',
                                        color: '#1e293b',
                                        cursor: 'pointer',
                                        padding: '4px'
                                    }
                                }, React.createElement(XIcon))
                            ),
                            React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px', marginBottom: '16px' } },
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'Ê¨æÂºè'),
                                    React.createElement('select', {
                                        value: filters.style,
                                        onChange: (e) => setFilters({...filters, style: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'ÂÖ®ÈÉ®Ê¨æÂºè'),
                                        ...filterOptions.styles.map(s => React.createElement('option', { key: s, value: s }, s))
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'ÂìÅÁâå'),
                                    React.createElement('select', {
                                        value: filters.brand,
                                        onChange: (e) => setFilters({...filters, brand: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'ÂÖ®ÈÉ®ÂìÅÁâå'),
                                        ...filterOptions.brands.map(b => React.createElement('option', { key: b, value: b }, b))
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'È¢úËâ≤'),
                                    React.createElement('select', {
                                        value: filters.color,
                                        onChange: (e) => setFilters({...filters, color: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'ÂÖ®ÈÉ®È¢úËâ≤'),
                                        ...filterOptions.colors.map(c => React.createElement('option', { key: c, value: c }, c))
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'Â∞∫Á†Å'),
                                    React.createElement('select', {
                                        value: filters.size,
                                        onChange: (e) => setFilters({...filters, size: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'ÂÖ®ÈÉ®Â∞∫Á†Å'),
                                        ...filterOptions.sizes.map(s => React.createElement('option', { key: s, value: s }, s))
                                    )
                                )
                            ),
                            React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' } },
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'ÂºÄÂßãÊó•Êúü'),
                                    React.createElement('input', {
                                        type: 'date',
                                        value: filters.startDate,
                                        onChange: (e) => setFilters({...filters, startDate: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'ÁªìÊùüÊó•Êúü'),
                                    React.createElement('input', {
                                        type: 'date',
                                        value: filters.endDate,
                                        onChange: (e) => setFilters({...filters, endDate: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'Êó∂Èó¥Á≤íÂ∫¶'),
                                    React.createElement('select', {
                                        value: filters.timeGranularity,
                                        onChange: (e) => setFilters({...filters, timeGranularity: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: '#f8fafc',
                                            border: '1px solid #e2e8f0',
                                            borderRadius: '8px',
                                            color: '#1e293b',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: 'day' }, 'ÊåâÂ§©'),
                                        React.createElement('option', { value: 'week' }, 'ÊåâÂë®'),
                                        React.createElement('option', { value: 'month' }, 'ÊåâÊúà')
                                    )
                                )
                            ),
                            React.createElement('button', {
                                onClick: () => setFilters({style: '', brand: '', color: '', size: '', startDate: '', endDate: '', timeGranularity: 'day'}),
                                style: {
                                    marginTop: '16px',
                                    padding: '8px 16px',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: 'none',
                                    color: '#1e293b',
                                    cursor: 'pointer'
                                }
                            }, 'Ê∏ÖÈô§Á≠õÈÄâ')
                        ),

                        // ÁªüËÆ°Âç°Áâá
                        React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '24px', marginBottom: '32px' } },
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(96, 165, 250, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(PackageIcon),
                                    React.createElement('h3', { style: { color: '#64748b' } }, 'ÊÄªÈîÄÈáè')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, stats.totalQuantity),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#64748b', marginTop: '4px' } }, '‰ª∂')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(16, 185, 129, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(DollarSignIcon),
                                    React.createElement('h3', { style: { color: '#64748b' } }, 'ÊÄªÈîÄÂîÆÈ¢ù')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, `‚Ç¨${stats.totalRevenue.toFixed(2)}`),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#64748b', marginTop: '4px' } }, 'Ê¨ßÂÖÉ')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(124, 58, 237, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(167, 139, 250, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(TrendingUpIcon),
                                    React.createElement('h3', { style: { color: '#64748b' } }, 'Âπ≥ÂùáÂçï‰ª∑')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, `‚Ç¨${stats.avgPrice.toFixed(2)}`),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#64748b', marginTop: '4px' } }, 'Ê¨ßÂÖÉ/‰ª∂')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(234, 88, 12, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(251, 146, 60, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(CalendarIcon),
                                    React.createElement('h3', { style: { color: '#64748b' } }, 'ÈîÄÂîÆÊµÅÈÄü')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, stats.velocity.toFixed(2)),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#64748b', marginTop: '4px' } }, '‰ª∂/Â§©')
                            )
                        ),

                        // ÂõæË°®Âå∫Âüü
                        React.createElement('div', { style: { display: 'flex', flexDirection: 'column', gap: '24px' } },
                            // ÈîÄÈáèË∂ãÂäøÂõæ
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'ÈîÄÈáèË∂ãÂäø'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center' } },
                                    React.createElement(CanvasLineChart, { 
                                        data: trendData.map(d => ({ date: d.date, quantity: d.quantity })), 
                                        width: 800, 
                                        height: 300, 
                                        color: '#3b82f6', 
                                        label: 'ÈîÄÈáè' 
                                    })
                                )
                            ),

                            // ÈîÄÂîÆÈ¢ùË∂ãÂäøÂõæ
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'ÈîÄÂîÆÈ¢ùË∂ãÂäø'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center' } },
                                    React.createElement(CanvasLineChart, { 
                                        data: trendData.map(d => ({ date: d.date, revenue: d.revenue })), 
                                        width: 800, 
                                        height: 300, 
                                        color: '#10b981', 
                                        label: 'ÈîÄÂîÆÈ¢ù' 
                                    })
                                )
                            ),

                            // Ê¨æÂºèÈîÄÈáè
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px', color: '#1e293b' } }, 'Ê¨æÂºèÈîÄÈáèÊéíË°åÔºàTop 10Ôºâ'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center', overflowX: 'auto' } },
                                    React.createElement(CanvasBarChart, { 
                                        data: styleData, 
                                        width: 1000, 
                                        height: 400, 
                                        color: '#8b5cf6', 
                                        label: 'ÈîÄÈáè',
                                        horizontal: true
                                    })
                                )
                            ),

                            // È¢úËâ≤ÈîÄÈáè
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.9)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(0, 0, 0, 0.1)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px', color: '#1e293b' } }, 'È¢úËâ≤ÈîÄÈáèÂàÜÂ∏É'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center' } },
                                    React.createElement(CanvasPieChart, { 
                                        data: colorData, 
                                        width: 700, 
                                        height: 500
                                    })
                                )
                            ),

                            // Â∞∫Á†ÅÈîÄÈáè
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.9)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(0, 0, 0, 0.1)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px', color: '#1e293b' } }, 'Â∞∫Á†ÅÈîÄÈáèÂàÜÂ∏É'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center' } },
                                    React.createElement(CanvasPieChart, { 
                                        data: sizeData, 
                                        width: 700, 
                                        height: 500
                                    })
                                )
                            ),

                            // ÂìÅÁâåÈîÄÈáèÂØπÊØî
                            brandData.length > 0 && React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.9)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(0, 0, 0, 0.1)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px', color: '#1e293b' } }, 'ÂìÅÁâåÈîÄÈáèÂØπÊØî'),
                                React.createElement('div', { style: { width: '100%', display: 'flex', justifyContent: 'center' } },
                                    React.createElement(CanvasPieChart, { 
                                        data: brandData, 
                                        width: 700, 
                                        height: 500,
                                        showRevenue: true
                                    })
                                )
                            )
                        )
                    )
                )
            );
        };

        // ÂàùÂßãÂåñÂàÜÊûêÁ≥ªÁªü
        function initAnalysisSystem() {
            console.log('ÂºÄÂßãÂàùÂßãÂåñÂàÜÊûêÁ≥ªÁªü...');
            
            // Ê£ÄÊü•‰æùËµñÊòØÂê¶Âä†ËΩΩ
            console.log('Ê£ÄÊü• React:', typeof React !== 'undefined');
            console.log('Ê£ÄÊü• ReactDOM:', typeof ReactDOM !== 'undefined');
            
            if (typeof React === 'undefined') {
                console.error('React Êú™Âä†ËΩΩ');
                const rootEl = document.getElementById('root');
                if (rootEl) {
                    rootEl.innerHTML = '<div style="padding: 50px; text-align: center; color: white;"><h2>Âä†ËΩΩÈîôËØØ</h2><p>React Â∫ìÊú™Âä†ËΩΩÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•</p><p>ËØ∑ÊâìÂºÄÊµèËßàÂô®ÊéßÂà∂Âè∞Êü•ÁúãËØ¶ÁªÜÈîôËØØ</p></div>';
                }
                return;
            }
            
            if (typeof ReactDOM === 'undefined') {
                console.error('ReactDOM Êú™Âä†ËΩΩ');
                const rootEl = document.getElementById('root');
                if (rootEl) {
                    rootEl.innerHTML = '<div style="padding: 50px; text-align: center; color: white;"><h2>Âä†ËΩΩÈîôËØØ</h2><p>ReactDOM Â∫ìÊú™Âä†ËΩΩÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•</p></div>';
                }
                return;
            }

            const rootElement = document.getElementById('root');
            if (!rootElement) {
                console.error('Êâæ‰∏çÂà∞ root ÂÖÉÁ¥†');
                return;
            }

            try {
                console.log('Â∞ùËØïÊ∏≤ÊüìÁªÑ‰ª∂...');
                // React 18 ‰ΩøÁî® createRoot
                if (ReactDOM.createRoot) {
                    console.log('‰ΩøÁî® ReactDOM.createRoot');
                    const root = ReactDOM.createRoot(rootElement);
                    root.render(React.createElement(SalesAnalysisSystem));
                    console.log('ÁªÑ‰ª∂Ê∏≤ÊüìÂÆåÊàê');
                } else if (ReactDOM.render) {
                    console.log('‰ΩøÁî® ReactDOM.render');
                    ReactDOM.render(React.createElement(SalesAnalysisSystem), rootElement);
                    console.log('ÁªÑ‰ª∂Ê∏≤ÊüìÂÆåÊàê');
                } else {
                    throw new Error('ReactDOM ÊñπÊ≥ï‰∏çÂèØÁî®');
                }
            } catch (error) {
                console.error('ÂàùÂßãÂåñÂ§±Ë¥•:', error);
                console.error('ÈîôËØØÂ†ÜÊ†à:', error.stack);
                rootElement.innerHTML = '<div style="padding: 50px; text-align: center; color: white;"><h2>ÂàùÂßãÂåñÈîôËØØ</h2><p>' + error.message + '</p><p>ËØ∑ÊâìÂºÄÊµèËßàÂô®ÊéßÂà∂Âè∞Êü•ÁúãËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ</p><p>ËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï</p></div>';
            }
        }

        // Á≠âÂæÖÊâÄÊúâËÑöÊú¨Âä†ËΩΩÂÆåÊàêÂêéÂÜçÂàùÂßãÂåñ
        async function waitForDependencies() {
            console.log('Á≠âÂæÖ‰æùËµñÂä†ËΩΩ...');
            const hasReact = typeof React !== 'undefined';
            const hasReactDOM = typeof ReactDOM !== 'undefined';
            
            console.log('‰æùËµñÁä∂ÊÄÅ - React:', hasReact, 'ReactDOM:', hasReactDOM);
            
            // Á≠âÂæÖ React Âíå ReactDOM Âä†ËΩΩ
            if (!hasReact || !hasReactDOM) {
                console.log('Á≠âÂæÖÊ†∏ÂøÉ‰æùËµñÂä†ËΩΩ...');
                // Â¶ÇÊûú‰æùËµñÊú™Âä†ËΩΩÔºåÁ≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÂêéÈáçËØïÔºàÊúÄÂ§öÁ≠âÂæÖ10ÁßíÔºâ
                const maxWait = 10000; // 10Áßí
                const startTime = Date.now();
                await new Promise((resolve) => {
                    const checkInterval = setInterval(() => {
                        const hasReactNow = typeof React !== 'undefined';
                        const hasReactDOMNow = typeof ReactDOM !== 'undefined';
                        
                        console.log('Ê£ÄÊü•‰æùËµñ - React:', hasReactNow, 'ReactDOM:', hasReactDOMNow);
                        
                        if (hasReactNow && hasReactDOMNow) {
                            clearInterval(checkInterval);
                            console.log('Ê†∏ÂøÉ‰æùËµñÂ∑≤Âä†ËΩΩ');
                            resolve();
                        } else if (Date.now() - startTime > maxWait) {
                            clearInterval(checkInterval);
                            console.error('Âä†ËΩΩË∂ÖÊó∂');
                            const rootEl = document.getElementById('root');
                            if (rootEl) {
                                rootEl.innerHTML = '<div style="padding: 50px; text-align: center; color: white;"><h2>Âä†ËΩΩË∂ÖÊó∂</h2><p>React Êàñ ReactDOM Âä†ËΩΩÊó∂Èó¥ËøáÈïø</p><p>ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÂêéÂà∑Êñ∞È°µÈù¢</p><p>ËØ∑ÊâìÂºÄÊµèËßàÂô®ÊéßÂà∂Âè∞Êü•ÁúãËØ¶ÁªÜÈîôËØØ</p></div>';
                            }
                            resolve();
                        }
                    }, 100);
                });
            }
            
            // ‰∏çÂÜçÈúÄË¶ÅÂä†ËΩΩ RechartsÔºå‰ΩøÁî®ÂéüÁîü Canvas
            // Á≠âÂæÖ‰∏Ä‰∏ãÁ°Æ‰øùÊâÄÊúâËÑöÊú¨ÈÉΩÂä†ËΩΩÂÆåÊàê
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // ÂàùÂßãÂåñÁ≥ªÁªü
            console.log('ÂºÄÂßãÂàùÂßãÂåñÁ≥ªÁªü');
            initAnalysisSystem();
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', waitForDependencies);
        } else {
            waitForDependencies();
        }
    </script>
</body>
</html>

