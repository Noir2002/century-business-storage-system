<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å“é”€é‡åˆ†æç³»ç»Ÿ - Century Business</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>">
    <!-- ä¾èµ–åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- React and Recharts for Analysis System -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.10.3/dist/Recharts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #7c3aed 50%, #1e293b 100%);
            min-height: 100vh;
            color: white;
        }

        #root {
            min-height: 100vh;
            padding: 32px;
        }

        #root * {
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // åˆ†æç³»ç»ŸReactç»„ä»¶
        const { useState, useMemo } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, BarChart, Bar } = Recharts;

        // é¢œè‰²ä»£ç æ˜ å°„è¡¨
        const COLOR_MAP = {
            'BLK': 'é»‘è‰²', 'WHT': 'ç™½è‰²', 'RED': 'çº¢è‰²', 'BLU': 'è“è‰²', 'GRN': 'ç»¿è‰²',
            'YEL': 'é»„è‰²', 'ORG': 'æ©™è‰²', 'PNK': 'ç²‰è‰²', 'PUR': 'ç´«è‰²', 'GRY': 'ç°è‰²',
            'BRN': 'æ£•è‰²', 'BGE': 'ç±³è‰²', 'NVY': 'è—é’', 'GLD': 'é‡‘è‰²', 'SLV': 'é“¶è‰²',
            'BBLC': 'é»‘è“', 'WGRY': 'ç™½ç°', 'RBLK': 'çº¢é»‘', 'BWHT': 'è“ç™½', 'GBLK': 'ç»¿é»‘'
        };

        const SalesAnalysisSystem = () => {
            const [data, setData] = useState([]);
            const [filters, setFilters] = useState({
                style: '',
                color: '',
                size: '',
                startDate: '',
                endDate: '',
                timeGranularity: 'day'
            });
            const [showFilters, setShowFilters] = useState(false);

            // è§£æSKUè·å–é¢œè‰²
            const parseColor = (sku) => {
                if (!sku) return 'æœªçŸ¥';
                const parts = sku.split('-');
                if (parts.length >= 2) {
                    const colorCode = parts[1].toUpperCase();
                    return COLOR_MAP[colorCode] || colorCode;
                }
                return 'æœªçŸ¥';
            };

            // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const workbook = XLSX.read(event.target.result, { type: 'binary' });
                        const sheetName = workbook.SheetNames[0];
                        const sheet = workbook.Sheets[sheetName];
                        const rawData = XLSX.utils.sheet_to_json(sheet);

                        const processedData = rawData.map(row => {
                            const getName = () => {
                                return row['å•†å“åç§°'] || row['åç§°'] || row['product_name'] || row['name'] || '';
                            };
                            const getSKU = () => {
                                return row['SKU'] || row['sku'] || row['å•†å“ç¼–ç '] || '';
                            };
                            const getSize = () => {
                                return row['å°ºç '] || row['size'] || row['è§„æ ¼'] || '';
                            };
                            const getQuantity = () => {
                                return parseInt(row['æ•°é‡'] || row['quantity'] || row['é”€é‡'] || 0);
                            };
                            const getPrice = () => {
                                return parseFloat(row['è®¢å•é‡‘é¢'] || row['price'] || row['å•ä»·'] || row['å•†å“å•ä»·'] || 0);
                            };
                            const getDate = () => {
                                const dateStr = row['åº—é“ºè®¢å•æ—¶é—´'] || row['è®¢å•æ—¶é—´'] || row['date'] || row['æ—¶é—´'] || '';
                                return dateStr ? new Date(dateStr) : new Date();
                            };

                            const name = getName();
                            const sku = getSKU();
                            
                            return {
                                style: name,
                                sku: sku,
                                color: parseColor(sku),
                                size: String(getSize()),
                                quantity: getQuantity(),
                                price: getPrice(),
                                date: getDate(),
                                revenue: getQuantity() * getPrice()
                            };
                        }).filter(item => item.style && item.quantity > 0);

                        setData(processedData);
                    } catch (error) {
                        alert('æ–‡ä»¶è§£æå¤±è´¥ï¼Œè¯·ç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®');
                        console.error(error);
                    }
                };
                reader.readAsBinaryString(file);
            };

            // è·å–ç­›é€‰é€‰é¡¹
            const filterOptions = useMemo(() => {
                return {
                    styles: [...new Set(data.map(d => d.style))].sort(),
                    colors: [...new Set(data.map(d => d.color))].sort(),
                    sizes: [...new Set(data.map(d => d.size))].sort()
                };
            }, [data]);

            // åº”ç”¨ç­›é€‰
            const filteredData = useMemo(() => {
                return data.filter(item => {
                    if (filters.style && item.style !== filters.style) return false;
                    if (filters.color && item.color !== filters.color) return false;
                    if (filters.size && item.size !== filters.size) return false;
                    if (filters.startDate && item.date < new Date(filters.startDate)) return false;
                    if (filters.endDate && item.date > new Date(filters.endDate)) return false;
                    return true;
                });
            }, [data, filters]);

            // æ ¼å¼åŒ–æ—¥æœŸ
            const formatDate = (date, granularity) => {
                const d = new Date(date);
                if (granularity === 'day') {
                    return `${d.getMonth() + 1}/${d.getDate()}`;
                } else if (granularity === 'week') {
                    const weekNum = Math.ceil((d.getDate()) / 7);
                    return `${d.getMonth() + 1}æœˆç¬¬${weekNum}å‘¨`;
                } else {
                    return `${d.getFullYear()}/${d.getMonth() + 1}`;
                }
            };

            // è®¡ç®—æ—¶é—´è¶‹åŠ¿æ•°æ®
            const trendData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    const key = formatDate(item.date, filters.timeGranularity);
                    if (!grouped[key]) {
                        grouped[key] = { date: key, quantity: 0, revenue: 0 };
                    }
                    grouped[key].quantity += item.quantity;
                    grouped[key].revenue += item.revenue;
                });
                return Object.values(grouped).sort((a, b) => {
                    const aDate = a.date.split(/[/æœˆå‘¨å¹´]/);
                    const bDate = b.date.split(/[/æœˆå‘¨å¹´]/);
                    return aDate[0] - bDate[0] || (aDate[1] || 0) - (bDate[1] || 0);
                });
            }, [filteredData, filters.timeGranularity]);

            // æŒ‰æ¬¾å¼ç»Ÿè®¡
            const styleData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.style]) {
                        grouped[item.style] = { name: item.style, quantity: 0, revenue: 0 };
                    }
                    grouped[item.style].quantity += item.quantity;
                    grouped[item.style].revenue += item.revenue;
                });
                return Object.values(grouped).sort((a, b) => b.quantity - a.quantity).slice(0, 10);
            }, [filteredData]);

            // æŒ‰é¢œè‰²ç»Ÿè®¡
            const colorData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.color]) {
                        grouped[item.color] = { name: item.color, quantity: 0 };
                    }
                    grouped[item.color].quantity += item.quantity;
                });
                return Object.values(grouped).sort((a, b) => b.quantity - a.quantity);
            }, [filteredData]);

            // æŒ‰å°ºç ç»Ÿè®¡
            const sizeData = useMemo(() => {
                const grouped = {};
                filteredData.forEach(item => {
                    if (!grouped[item.size]) {
                        grouped[item.size] = { name: item.size, quantity: 0 };
                    }
                    grouped[item.size].quantity += item.quantity;
                });
                return Object.values(grouped).sort((a, b) => {
                    const aNum = parseFloat(a.name) || 0;
                    const bNum = parseFloat(b.name) || 0;
                    return aNum - bNum;
                });
            }, [filteredData]);

            // è®¡ç®—ç»Ÿè®¡æ•°æ®
            const stats = useMemo(() => {
                const totalQuantity = filteredData.reduce((sum, item) => sum + item.quantity, 0);
                const totalRevenue = filteredData.reduce((sum, item) => sum + item.revenue, 0);
                const avgPrice = totalQuantity > 0 ? totalRevenue / totalQuantity : 0;
                
                const dates = filteredData.map(d => d.date.getTime());
                const daysDiff = dates.length > 0 ? 
                    (Math.max(...dates) - Math.min(...dates)) / (1000 * 60 * 60 * 24) + 1 : 1;
                const velocity = totalQuantity / daysDiff;

                return {
                    totalQuantity,
                    totalRevenue,
                    avgPrice,
                    velocity,
                    orderCount: filteredData.length
                };
            }, [filteredData]);

            // å¯¼å‡ºPDF
            const exportPDF = async () => {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                
                pdf.setFontSize(20);
                pdf.text('é”€é‡åˆ†ææŠ¥å‘Š', pageWidth / 2, 20, { align: 'center' });
                
                pdf.setFontSize(12);
                let yPos = 35;
                pdf.text(`æ€»é”€é‡: ${stats.totalQuantity} ä»¶`, 20, yPos);
                pdf.text(`æ€»é”€å”®é¢: Â¥${stats.totalRevenue.toFixed(2)}`, 20, yPos + 7);
                pdf.text(`å¹³å‡å•ä»·: Â¥${stats.avgPrice.toFixed(2)}`, 20, yPos + 14);
                pdf.text(`é”€å”®æµé€Ÿ: ${stats.velocity.toFixed(2)} ä»¶/å¤©`, 20, yPos + 21);
                
                const charts = document.querySelectorAll('.chart-container');
                yPos = 70;
                
                for (let i = 0; i < charts.length; i++) {
                    if (yPos > 250) {
                        pdf.addPage();
                        yPos = 20;
                    }
                    
                    try {
                        const canvas = await html2canvas(charts[i], { scale: 2 });
                        const imgData = canvas.toDataURL('image/png');
                        const imgWidth = pageWidth - 40;
                        const imgHeight = (canvas.height * imgWidth) / canvas.width;
                        
                        pdf.addImage(imgData, 'PNG', 20, yPos, imgWidth, imgHeight);
                        yPos += imgHeight + 10;
                    } catch (error) {
                        console.error('å›¾è¡¨å¯¼å‡ºå¤±è´¥:', error);
                    }
                }
                
                pdf.save(`é”€é‡åˆ†ææŠ¥å‘Š_${new Date().toLocaleDateString()}.pdf`);
            };

            // åˆ›å»ºå›¾æ ‡ç»„ä»¶ï¼ˆç®€åŒ–ç‰ˆï¼Œä½¿ç”¨SVGï¼‰
            const UploadIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4' }),
                React.createElement('polyline', { points: '17 8 12 3 7 8' }),
                React.createElement('line', { x1: 12, y1: 3, x2: 12, y2: 15 })
            );

            const FilterIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('polygon', { points: '22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3' })
            );

            const DownloadIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4' }),
                React.createElement('polyline', { points: '7 10 12 15 17 10' }),
                React.createElement('line', { x1: 12, y1: 15, x2: 12, y2: 3 })
            );

            const XIcon = () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 18, y1: 6, x2: 6, y2: 18 }),
                React.createElement('line', { x1: 6, y1: 6, x2: 18, y2: 18 })
            );

            const PackageIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 16.5, y1: 9.4, x2: 7.5, y2: 4.21 }),
                React.createElement('path', { d: 'M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z' }),
                React.createElement('polyline', { points: '3.27 6.96 12 12.01 20.73 6.96' }),
                React.createElement('line', { x1: 12, y1: 22.08, x2: 12, y2: 12 })
            );

            const DollarSignIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 12, y1: 1, x2: 12, y2: 23 }),
                React.createElement('path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6' })
            );

            const TrendingUpIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('polyline', { points: '23 6 13.5 15.5 8.5 10.5 1 18' }),
                React.createElement('polyline', { points: '17 6 23 6 23 12' })
            );

            const CalendarIcon = () => React.createElement('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('rect', { x: 3, y: 4, width: 18, height: 18, rx: 2, ry: 2 }),
                React.createElement('line', { x1: 16, y1: 2, x2: 16, y2: 6 }),
                React.createElement('line', { x1: 8, y1: 2, x2: 8, y2: 6 }),
                React.createElement('line', { x1: 3, y1: 10, x2: 21, y2: 10 })
            );

            return React.createElement('div', { 
                style: { 
                    minHeight: '100vh', 
                    background: 'linear-gradient(135deg, #1e293b 0%, #7c3aed 50%, #1e293b 100%)', 
                    color: 'white', 
                    padding: '32px' 
                } 
            },
                React.createElement('div', { style: { maxWidth: '1280px', margin: '0 auto' } },
                    // å¤´éƒ¨
                    React.createElement('div', { style: { marginBottom: '32px' } },
                        React.createElement('h1', { 
                            style: { 
                                fontSize: '2.25rem', 
                                fontWeight: 'bold', 
                                marginBottom: '8px',
                                background: 'linear-gradient(to right, #60a5fa, #a78bfa)',
                                WebkitBackgroundClip: 'text',
                                WebkitTextFillColor: 'transparent'
                            } 
                        }, 'å•†å“é”€é‡åˆ†æç³»ç»Ÿ'),
                        React.createElement('p', { style: { color: '#94a3b8' } }, 'æ•°æ®é©±åŠ¨å†³ç­–ï¼Œæ´å¯Ÿé”€å”®è¶‹åŠ¿')
                    ),

                    // ä¸Šä¼ åŒºåŸŸ
                    data.length === 0 && React.createElement('div', { 
                        style: { 
                            backdropFilter: 'blur(16px)', 
                            background: 'rgba(255, 255, 255, 0.1)', 
                            borderRadius: '16px', 
                            border: '1px solid rgba(255, 255, 255, 0.2)', 
                            padding: '48px', 
                            textAlign: 'center', 
                            marginBottom: '32px',
                            transition: 'all 0.3s'
                        } 
                    },
                        React.createElement(UploadIcon),
                        React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginTop: '16px', marginBottom: '8px' } }, 'ä¸Šä¼ Excelæ–‡ä»¶'),
                        React.createElement('p', { style: { color: '#94a3b8', marginBottom: '16px' } }, 'æ”¯æŒ .xlsx, .xls æ ¼å¼'),
                        React.createElement('label', { style: { display: 'inline-block', cursor: 'pointer' } },
                            React.createElement('input', { 
                                type: 'file', 
                                accept: '.xlsx,.xls', 
                                onChange: handleFileUpload, 
                                style: { display: 'none' } 
                            }),
                            React.createElement('span', { 
                                style: { 
                                    display: 'inline-block',
                                    padding: '12px 24px', 
                                    background: 'linear-gradient(to right, #3b82f6, #8b5cf6)', 
                                    borderRadius: '8px', 
                                    fontWeight: '600',
                                    transition: 'all 0.3s'
                                } 
                            }, 'é€‰æ‹©æ–‡ä»¶')
                        )
                    ),

                    // æ•°æ®å±•ç¤ºåŒº
                    data.length > 0 && React.createElement(React.Fragment, null,
                        // æ“ä½œæ 
                        React.createElement('div', { style: { display: 'flex', gap: '16px', marginBottom: '24px' } },
                            React.createElement('button', {
                                onClick: () => setShowFilters(!showFilters),
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    backdropFilter: 'blur(16px)',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: '1px solid rgba(255, 255, 255, 0.2)',
                                    color: 'white',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            }, React.createElement(FilterIcon), 'ç­›é€‰å™¨'),
                            React.createElement('button', {
                                onClick: exportPDF,
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    background: 'linear-gradient(to right, #10b981, #059669)',
                                    borderRadius: '8px',
                                    color: 'white',
                                    border: 'none',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            }, React.createElement(DownloadIcon), 'å¯¼å‡ºPDF'),
                            React.createElement('label', {
                                style: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '8px 16px',
                                    backdropFilter: 'blur(16px)',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: '1px solid rgba(255, 255, 255, 0.2)',
                                    color: 'white',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s'
                                }
                            },
                                React.createElement(UploadIcon),
                                'é‡æ–°ä¸Šä¼ ',
                                React.createElement('input', { 
                                    type: 'file', 
                                    accept: '.xlsx,.xls', 
                                    onChange: handleFileUpload, 
                                    style: { display: 'none' } 
                                })
                            )
                        ),

                        // ç­›é€‰é¢æ¿
                        showFilters && React.createElement('div', { 
                            style: { 
                                backdropFilter: 'blur(16px)', 
                                background: 'rgba(255, 255, 255, 0.1)', 
                                borderRadius: '16px', 
                                border: '1px solid rgba(255, 255, 255, 0.2)', 
                                padding: '24px', 
                                marginBottom: '24px' 
                            } 
                        },
                            React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' } },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600' } }, 'ç­›é€‰æ¡ä»¶'),
                                React.createElement('button', {
                                    onClick: () => setShowFilters(false),
                                    style: {
                                        background: 'transparent',
                                        border: 'none',
                                        color: 'white',
                                        cursor: 'pointer',
                                        padding: '4px'
                                    }
                                }, React.createElement(XIcon))
                            ),
                            React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px', marginBottom: '16px' } },
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'æ¬¾å¼'),
                                    React.createElement('select', {
                                        value: filters.style,
                                        onChange: (e) => setFilters({...filters, style: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'å…¨éƒ¨æ¬¾å¼'),
                                        ...filterOptions.styles.map(s => React.createElement('option', { key: s, value: s }, s))
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'é¢œè‰²'),
                                    React.createElement('select', {
                                        value: filters.color,
                                        onChange: (e) => setFilters({...filters, color: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'å…¨éƒ¨é¢œè‰²'),
                                        ...filterOptions.colors.map(c => React.createElement('option', { key: c, value: c }, c))
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'å°ºç '),
                                    React.createElement('select', {
                                        value: filters.size,
                                        onChange: (e) => setFilters({...filters, size: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: '' }, 'å…¨éƒ¨å°ºç '),
                                        ...filterOptions.sizes.map(s => React.createElement('option', { key: s, value: s }, s))
                                    )
                                )
                            ),
                            React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' } },
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'å¼€å§‹æ—¥æœŸ'),
                                    React.createElement('input', {
                                        type: 'date',
                                        value: filters.startDate,
                                        onChange: (e) => setFilters({...filters, startDate: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'ç»“æŸæ—¥æœŸ'),
                                    React.createElement('input', {
                                        type: 'date',
                                        value: filters.endDate,
                                        onChange: (e) => setFilters({...filters, endDate: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', marginBottom: '8px' } }, 'æ—¶é—´ç²’åº¦'),
                                    React.createElement('select', {
                                        value: filters.timeGranularity,
                                        onChange: (e) => setFilters({...filters, timeGranularity: e.target.value}),
                                        style: {
                                            width: '100%',
                                            padding: '8px 12px',
                                            background: 'rgba(255, 255, 255, 0.05)',
                                            border: '1px solid rgba(255, 255, 255, 0.2)',
                                            borderRadius: '8px',
                                            color: 'white',
                                            outline: 'none'
                                        }
                                    },
                                        React.createElement('option', { value: 'day' }, 'æŒ‰å¤©'),
                                        React.createElement('option', { value: 'week' }, 'æŒ‰å‘¨'),
                                        React.createElement('option', { value: 'month' }, 'æŒ‰æœˆ')
                                    )
                                )
                            ),
                            React.createElement('button', {
                                onClick: () => setFilters({style: '', color: '', size: '', startDate: '', endDate: '', timeGranularity: 'day'}),
                                style: {
                                    marginTop: '16px',
                                    padding: '8px 16px',
                                    background: 'rgba(255, 255, 255, 0.1)',
                                    borderRadius: '8px',
                                    border: 'none',
                                    color: 'white',
                                    cursor: 'pointer'
                                }
                            }, 'æ¸…é™¤ç­›é€‰')
                        ),

                        // ç»Ÿè®¡å¡ç‰‡
                        React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '24px', marginBottom: '32px' } },
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(96, 165, 250, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(PackageIcon),
                                    React.createElement('h3', { style: { color: '#cbd5e1' } }, 'æ€»é”€é‡')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, stats.totalQuantity),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#94a3b8', marginTop: '4px' } }, 'ä»¶')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(16, 185, 129, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(DollarSignIcon),
                                    React.createElement('h3', { style: { color: '#cbd5e1' } }, 'æ€»é”€å”®é¢')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, `Â¥${stats.totalRevenue.toFixed(2)}`),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#94a3b8', marginTop: '4px' } }, 'å…ƒ')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(124, 58, 237, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(167, 139, 250, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(TrendingUpIcon),
                                    React.createElement('h3', { style: { color: '#cbd5e1' } }, 'å¹³å‡å•ä»·')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, `Â¥${stats.avgPrice.toFixed(2)}`),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#94a3b8', marginTop: '4px' } }, 'å…ƒ/ä»¶')
                            ),
                            React.createElement('div', { 
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(234, 88, 12, 0.2))', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(251, 146, 60, 0.3)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '8px' } },
                                    React.createElement(CalendarIcon),
                                    React.createElement('h3', { style: { color: '#cbd5e1' } }, 'é”€å”®æµé€Ÿ')
                                ),
                                React.createElement('p', { style: { fontSize: '1.875rem', fontWeight: 'bold' } }, stats.velocity.toFixed(2)),
                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#94a3b8', marginTop: '4px' } }, 'ä»¶/å¤©')
                            )
                        ),

                        // å›¾è¡¨åŒºåŸŸ
                        React.createElement('div', { style: { display: 'flex', flexDirection: 'column', gap: '24px' } },
                            // é”€é‡è¶‹åŠ¿å›¾
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'é”€é‡è¶‹åŠ¿'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(LineChart, { data: trendData },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3', stroke: 'rgba(255, 255, 255, 0.2)' }),
                                        React.createElement(XAxis, { dataKey: 'date', stroke: '#94a3b8' }),
                                        React.createElement(YAxis, { stroke: '#94a3b8' }),
                                        React.createElement(Tooltip, { 
                                            contentStyle: { 
                                                backgroundColor: '#1e293b', 
                                                border: '1px solid #475569', 
                                                borderRadius: '8px' 
                                            } 
                                        }),
                                        React.createElement(Legend),
                                        React.createElement(Line, { 
                                            type: 'monotone', 
                                            dataKey: 'quantity', 
                                            stroke: '#3b82f6', 
                                            strokeWidth: 3, 
                                            name: 'é”€é‡', 
                                            dot: { fill: '#3b82f6', r: 4 } 
                                        })
                                    )
                                )
                            ),

                            // é”€å”®é¢è¶‹åŠ¿å›¾
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'é”€å”®é¢è¶‹åŠ¿'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(LineChart, { data: trendData },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3', stroke: 'rgba(255, 255, 255, 0.2)' }),
                                        React.createElement(XAxis, { dataKey: 'date', stroke: '#94a3b8' }),
                                        React.createElement(YAxis, { stroke: '#94a3b8' }),
                                        React.createElement(Tooltip, { 
                                            contentStyle: { 
                                                backgroundColor: '#1e293b', 
                                                border: '1px solid #475569', 
                                                borderRadius: '8px' 
                                            } 
                                        }),
                                        React.createElement(Legend),
                                        React.createElement(Line, { 
                                            type: 'monotone', 
                                            dataKey: 'revenue', 
                                            stroke: '#10b981', 
                                            strokeWidth: 3, 
                                            name: 'é”€å”®é¢', 
                                            dot: { fill: '#10b981', r: 4 } 
                                        })
                                    )
                                )
                            ),

                            // æ¬¾å¼é”€é‡
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'æ¬¾å¼é”€é‡æ’è¡Œï¼ˆTop 10ï¼‰'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 400 },
                                    React.createElement(BarChart, { data: styleData, layout: 'vertical' },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3', stroke: 'rgba(255, 255, 255, 0.2)' }),
                                        React.createElement(XAxis, { type: 'number', stroke: '#94a3b8' }),
                                        React.createElement(YAxis, { dataKey: 'name', type: 'category', width: 150, stroke: '#94a3b8' }),
                                        React.createElement(Tooltip, { 
                                            contentStyle: { 
                                                backgroundColor: '#1e293b', 
                                                border: '1px solid #475569', 
                                                borderRadius: '8px' 
                                            } 
                                        }),
                                        React.createElement(Bar, { dataKey: 'quantity', fill: '#8b5cf6', name: 'é”€é‡' })
                                    )
                                )
                            ),

                            // é¢œè‰²é”€é‡
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'é¢œè‰²é”€é‡åˆ†å¸ƒ'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(BarChart, { data: colorData },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3', stroke: 'rgba(255, 255, 255, 0.2)' }),
                                        React.createElement(XAxis, { dataKey: 'name', stroke: '#94a3b8' }),
                                        React.createElement(YAxis, { stroke: '#94a3b8' }),
                                        React.createElement(Tooltip, { 
                                            contentStyle: { 
                                                backgroundColor: '#1e293b', 
                                                border: '1px solid #475569', 
                                                borderRadius: '8px' 
                                            } 
                                        }),
                                        React.createElement(Bar, { dataKey: 'quantity', fill: '#ec4899', name: 'é”€é‡' })
                                    )
                                )
                            ),

                            // å°ºç é”€é‡
                            React.createElement('div', { 
                                className: 'chart-container',
                                style: { 
                                    backdropFilter: 'blur(16px)', 
                                    background: 'rgba(255, 255, 255, 0.1)', 
                                    borderRadius: '16px', 
                                    border: '1px solid rgba(255, 255, 255, 0.2)', 
                                    padding: '24px' 
                                } 
                            },
                                React.createElement('h3', { style: { fontSize: '1.25rem', fontWeight: '600', marginBottom: '16px' } }, 'å°ºç é”€é‡åˆ†å¸ƒ'),
                                React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                    React.createElement(BarChart, { data: sizeData },
                                        React.createElement(CartesianGrid, { strokeDasharray: '3 3', stroke: 'rgba(255, 255, 255, 0.2)' }),
                                        React.createElement(XAxis, { dataKey: 'name', stroke: '#94a3b8' }),
                                        React.createElement(YAxis, { stroke: '#94a3b8' }),
                                        React.createElement(Tooltip, { 
                                            contentStyle: { 
                                                backgroundColor: '#1e293b', 
                                                border: '1px solid #475569', 
                                                borderRadius: '8px' 
                                            } 
                                        }),
                                        React.createElement(Bar, { dataKey: 'quantity', fill: '#f59e0b', name: 'é”€é‡' })
                                    )
                                )
                            )
                        )
                    )
                )
            );
        };

        // åˆå§‹åŒ–åˆ†æç³»ç»Ÿ
        function initAnalysisSystem() {
            const rootElement = document.getElementById('root');
            if (rootElement) {
                // React 18 ä½¿ç”¨ createRoot
                if (ReactDOM.createRoot) {
                    const root = ReactDOM.createRoot(rootElement);
                    root.render(React.createElement(SalesAnalysisSystem));
                } else {
                    // å…¼å®¹æ—§ç‰ˆæœ¬
                    ReactDOM.render(React.createElement(SalesAnalysisSystem), rootElement);
                }
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAnalysisSystem);
        } else {
            initAnalysisSystem();
        }
    </script>
</body>
</html>

