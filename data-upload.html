<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æ•°æ®å¯¼å…¥ - æ•°æ®ç®¡ç†ç³»ç»Ÿ</title>
  <link href="./src/css/layui.css" rel="stylesheet">
  <link href="./src/css/app-header.css" rel="stylesheet">
  <script src="./api-config.js"></script>
  <script src="./simple-r2-storage.js"></script>
  <style>
    body {
      background: #f8f9fa;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .header .layui-nav {
      background: transparent;
    }
    .header .layui-nav .layui-nav-item a {
      color: rgba(255,255,255,0.9);
    }
    .header .layui-nav .layui-nav-item a:hover {
      color: white;
    }
    .header .logo {
      font-size: 18px;
      font-weight: bold;
      white-space: nowrap;
    }
    
    /* ä¸»å¯¼èˆªæ ·å¼ */
    .main-nav {
      flex: 1;
      display: flex;
      justify-content: center;
      margin: 0 20px;
    }
    .main-nav .layui-nav-item {
      margin: 0 5px;
    }
    .main-nav .layui-nav-item a {
      padding: 0 20px;
      border-radius: 6px;
      transition: all 0.3s ease;
      font-size: 14px;
    }
    .main-nav .layui-nav-item a:hover,
    .main-nav .layui-nav-item.layui-this a {
      background: rgba(255,255,255,0.2);
      color: white;
    }
    .main-nav .layui-nav-item a i {
      margin-right: 6px;
    }
    
    .header .user-info {
      white-space: nowrap;
    }
    
    /* ç”¨æˆ·ä¸‹æ‹‰èœå•æ ·å¼ */
    .user-info .layui-nav-child dd a {
      padding: 10px 15px;
      color: #666;
      transition: all 0.3s ease;
    }
    .user-info .layui-nav-child dd a:hover {
      background: #f8f9fa;
      color: #16baaa;
    }
    .user-info .layui-nav-child dd a i {
      margin-right: 8px;
      font-size: 14px;
    }
    
    .content-wrapper {
      padding: 20px;
    }
    
    .page-header {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .page-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin: 0;
    }
    .page-subtitle {
      color: #666;
      margin-top: 5px;
    }
    .breadcrumb {
      color: #999;
      font-size: 14px;
      margin-top: 10px;
    }
    .breadcrumb a {
      color: #16baaa;
      text-decoration: none;
    }
    
    .upload-section {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .upload-header {
      padding: 20px;
      border-bottom: 1px solid #f0f0f0;
      background: #fafafa;
    }
    .upload-content {
      padding: 30px;
    }
    
    .upload-area {
      border: 2px dashed #d9d9d9;
      border-radius: 10px;
      padding: 60px 20px;
      text-align: center;
      transition: border-color 0.3s;
      cursor: pointer;
      background: #fafafa;
    }
    .upload-area:hover {
      border-color: #16baaa;
      background: #f0fff4;
    }
    .upload-area.dragover {
      border-color: #16baaa;
      background: #e6f7ff;
    }
    .upload-icon {
      font-size: 48px;
      color: #16baaa;
      margin-bottom: 15px;
    }
    .upload-text {
      font-size: 16px;
      color: #333;
      margin-bottom: 10px;
    }
    .upload-hint {
      font-size: 14px;
      color: #999;
      margin-bottom: 20px;
    }
    
    .file-list {
      margin-top: 20px;
    }
    .file-item {
      display: flex;
      align-items: center;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .file-icon {
      font-size: 24px;
      color: #52c41a;
      margin-right: 15px;
    }
    .file-info {
      flex: 1;
    }
    .file-name {
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }
    .file-size {
      font-size: 12px;
      color: #999;
    }
    .file-progress {
      margin: 10px 0;
    }
    .file-actions {
      display: flex;
      gap: 10px;
    }
    
    .preview-section {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      display: none;
    }
    .preview-header {
      padding: 20px;
      border-bottom: 1px solid #f0f0f0;
      background: #fafafa;
    }
    .preview-content {
      padding: 20px;
    }
    .preview-table {
      width: 100%;
      font-size: 13px;
      border-collapse: collapse;
    }
    .preview-table th,
    .preview-table td {
      border: 1px solid #e6e6e6;
      padding: 8px;
      text-align: center;
    }
    .preview-table th {
      background: #f8f9fa;
      font-weight: bold;
    }
    
    .settings-section {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      display: none;
    }
    .settings-header {
      padding: 20px;
      border-bottom: 1px solid #f0f0f0;
      background: #fafafa;
    }
    .settings-content {
      padding: 20px;
    }
    
    .action-buttons {
      text-align: center;
      padding: 20px;
    }
    
    .tips-section {
      background: #fff7e6;
      border: 1px solid #ffd591;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .tips-title {
      font-weight: bold;
      color: #d46b08;
      margin-bottom: 10px;
    }
    .tips-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .tips-list li {
      color: #ad6800;
      margin-bottom: 5px;
      padding-left: 20px;
      position: relative;
    }
    .tips-list li:before {
      content: "â€¢";
      position: absolute;
      left: 0;
      color: #fa8c16;
    }
  </style>
</head>
<body>
  <div class="layui-header header">
    <div class="logo">
      ğŸ“Š æ•°æ®ç®¡ç†ç³»ç»Ÿ
    </div>
    
    <!-- ä¸»å¯¼èˆªæŒ‰é’® -->
    <ul class="layui-nav main-nav">
      <li class="layui-nav-item">
        <a href="dashboard.html">
          <i class="layui-icon layui-icon-home"></i> æ•°æ®ä»ªè¡¨ç›˜
        </a>
      </li>
      <li class="layui-nav-item">
        <a href="table-management.html">
          <i class="layui-icon layui-icon-table"></i> è¡¨æ ¼ç®¡ç†
        </a>
      </li>
      <li class="layui-nav-item layui-this">
        <a href="data-upload.html">
          <i class="layui-icon layui-icon-upload-drag"></i> æ•°æ®å¯¼å…¥
        </a>
      </li>
      <li class="layui-nav-item">
        <a href="arcteryx-data-analysis.html">
          <i class="layui-icon layui-icon-chart"></i> æ•°æ®åˆ†æ
        </a>
      </li>
      <li class="layui-nav-item">
        <a href="local-database.html">
          <i class="layui-icon layui-icon-database"></i> æœ¬åœ°æ•°æ®åº“
        </a>
      </li>
      <li class="layui-nav-item">
        <a href="tmall-database.html">
          <i class="layui-icon layui-icon-cart"></i> å¤©çŒ«æ•°æ®åº“
        </a>
      </li>
      <li class="layui-nav-item">
        <a href="tmall-order.html">
          <i class="layui-icon layui-icon-list"></i> å¤©çŒ«è®¢å•
        </a>
      </li>
      <li class="layui-nav-item" id="adminOnlyTopNav" style="display: none;">
        <a href="user-management.html">
          <i class="layui-icon layui-icon-username"></i> ç”¨æˆ·ç®¡ç†
        </a>
      </li>
    </ul>
    
    
  </div>
  
  <div class="content-wrapper">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header">
      <h1 class="page-title">ğŸ“¤ æ•°æ®å¯¼å…¥</h1>
      <p class="page-subtitle">å¯¼å…¥Excelæ–‡ä»¶ï¼Œæ‰¹é‡ç®¡ç†æ‚¨çš„SKUåº“å­˜é”€å”®æ•°æ®</p>
      <div class="breadcrumb">
        <a href="dashboard.html">é¦–é¡µ</a> / æ•°æ®å¯¼å…¥
      </div>
    </div>
    
    <!-- ä½¿ç”¨æç¤º -->
    <div class="tips-section">
      <div class="tips-title">ğŸ’¡ å¯¼å…¥æç¤º</div>
      <ul class="tips-list">
        <li>æ”¯æŒ .xlsxã€.xls æ ¼å¼çš„Excelæ–‡ä»¶</li>
        <li>å»ºè®®æ–‡ä»¶å¤§å°ä¸è¶…è¿‡50MBï¼Œæ”¯æŒå‡ åƒè¡Œæ•°æ®</li>
        <li>ç¬¬ä¸€è¡Œåº”ä¸ºåˆ—æ ‡é¢˜ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«</li>
        <li>æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œä¹Ÿå¯ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</li>
        <li>ä¸Šä¼ å‰ä¼šæä¾›æ•°æ®é¢„è§ˆï¼Œç¡®è®¤æ— è¯¯åå†å¯¼å…¥</li>
      </ul>
    </div>
    
    <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
    <div class="upload-section">
      <div class="upload-header">
        <h3>ğŸ“ é€‰æ‹©Excelæ–‡ä»¶</h3>
      </div>
      <div class="upload-content">
        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">ğŸ“Š</div>
          <div class="upload-text">æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</div>
          <div class="upload-hint">æ”¯æŒ .xlsxã€.xls æ ¼å¼ï¼Œæœ€å¤§50MB</div>
          <button class="layui-btn layui-btn-normal" id="selectFileBtn">
            <i class="layui-icon layui-icon-upload"></i> é€‰æ‹©æ–‡ä»¶
          </button>
          <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
        </div>
        
        <div class="file-list" id="fileList">
          <!-- åŠ¨æ€ç”Ÿæˆæ–‡ä»¶åˆ—è¡¨ -->
        </div>
      </div>
    </div>
    
    <!-- æ•°æ®é¢„è§ˆåŒºåŸŸ -->
    <div class="preview-section" id="previewSection">
      <div class="preview-header">
        <h3>ğŸ‘ï¸ æ•°æ®é¢„è§ˆ</h3>
        <p>è¯·ç¡®è®¤æ•°æ®æ ¼å¼æ­£ç¡®ï¼Œæ˜¾ç¤ºå‰10è¡Œæ•°æ®</p>
      </div>
      <div class="preview-content">
        <div style="overflow-x: auto;">
          <table class="preview-table" id="previewTable">
            <!-- åŠ¨æ€ç”Ÿæˆé¢„è§ˆè¡¨æ ¼ -->
          </table>
        </div>
      </div>
    </div>
    
    <!-- å¯¼å…¥è®¾ç½® -->
    <div class="settings-section" id="settingsSection">
      <div class="settings-header">
        <h3>âš™ï¸ å¯¼å…¥è®¾ç½®</h3>
      </div>
      <div class="settings-content">
        <form class="layui-form" lay-filter="importSettings">
          <div class="layui-row layui-col-space15">
            <div class="layui-col-md6">
              <div class="layui-form-item">
                <label class="layui-form-label">å¯¼å…¥æ–¹å¼</label>
                <div class="layui-input-block">
                  <input type="radio" name="importMode" value="replace" title="æ›¿æ¢ç°æœ‰æ•°æ®" checked>
                  <input type="radio" name="importMode" value="append" title="è¿½åŠ åˆ°ç°æœ‰æ•°æ®">
                </div>
              </div>
            </div>
            <div class="layui-col-md6">
              <div class="layui-form-item">
                <label class="layui-form-label">é¦–è¡Œå¤„ç†</label>
                <div class="layui-input-block">
                  <input type="radio" name="headerMode" value="skip" title="è·³è¿‡é¦–è¡Œï¼ˆä½œä¸ºæ ‡é¢˜ï¼‰" checked>
                  <input type="radio" name="headerMode" value="import" title="å¯¼å…¥é¦–è¡Œï¼ˆä½œä¸ºæ•°æ®ï¼‰">
                </div>
              </div>
            </div>
          </div>
          
          <div class="layui-form-item">
            <label class="layui-form-label">æ•°æ®éªŒè¯</label>
            <div class="layui-input-block">
              <input type="checkbox" name="validateData" title="å¯ç”¨æ•°æ®éªŒè¯" checked lay-skin="primary">
              <input type="checkbox" name="skipErrors" title="è·³è¿‡é”™è¯¯æ•°æ®" lay-skin="primary">
            </div>
          </div>
        </form>
      </div>
    </div>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <div class="action-buttons" id="actionButtons" style="display: none;">
      <button class="layui-btn layui-btn-lg" onclick="startImport()">
        <i class="layui-icon layui-icon-ok"></i> å¼€å§‹å¯¼å…¥
      </button>
      <button class="layui-btn layui-btn-primary layui-btn-lg" onclick="cancelImport()">
        å–æ¶ˆ
      </button>
    </div>
  </div>

  <script src="./src/layui.js"></script>
  <script>
    layui.use(['form', 'layer', 'upload'], function(){
      var form = layui.form;
      var layer = layui.layer;
      var upload = layui.upload;
      
              var userInfo = JSON.parse(localStorage.getItem('currentUser') || '{}');
      var currentFile = null;
      
      // åˆå§‹åŒ–é¡µé¢
      initPage();
      
      function initPage() {
        // æ£€æŸ¥ç™»å½•çŠ¶æ€å’Œæƒé™
        if (!userInfo.username) {
          layer.msg('è¯·å…ˆç™»å½•ï¼', {icon: 2}, function(){
            window.location.href = 'login.html';
          });
          return;
        }
        
        if (userInfo.role !== 'admin') {
          layer.msg('æ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢ï¼', {icon: 2}, function(){
            window.location.href = 'dashboard.html';
          });
          return;
        }
        
        // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
        var cu = document.getElementById('currentUser');
        if (cu) cu.textContent = userInfo.realname || userInfo.username;
        
        // æ˜¾ç¤ºç®¡ç†å‘˜ä¸“ç”¨å¯¼èˆª
        if (userInfo.role === 'admin') {
          document.getElementById('adminOnlyTopNav').style.display = 'block';
        }
        
        // åˆå§‹åŒ–æ‹–æ‹½ä¸Šä¼ 
        initDragUpload();
        
        // ç»‘å®šæ–‡ä»¶é€‰æ‹©
        document.getElementById('selectFileBtn').onclick = function() {
          document.getElementById('fileInput').click();
        };
        
        document.getElementById('fileInput').onchange = function(e) {
          handleFileSelect(e.target.files);
        };
      }
      
      function initDragUpload() {
        var uploadArea = document.getElementById('uploadArea');
        
        uploadArea.addEventListener('dragover', function(e) {
          e.preventDefault();
          uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', function(e) {
          e.preventDefault();
          uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', function(e) {
          e.preventDefault();
          uploadArea.classList.remove('dragover');
          handleFileSelect(e.dataTransfer.files);
        });
      }
      
      function handleFileSelect(files) {
        if (!files || files.length === 0) return;
        
        var file = files[0];
        
        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
        var allowedTypes = [
          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', // .xlsx
          'application/vnd.ms-excel' // .xls
        ];
        
        if (!allowedTypes.includes(file.type) && !file.name.match(/\.(xlsx|xls)$/i)) {
          layer.msg('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼ˆ.xlsxæˆ–.xlsæ ¼å¼ï¼‰', {icon: 2});
          return;
        }
        
        // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆ50MBï¼‰
        if (file.size > 50 * 1024 * 1024) {
          layer.msg('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡50MB', {icon: 2});
          return;
        }
        
        currentFile = file;
        displayFileInfo(file);
        
        // æ¨¡æ‹Ÿæ–‡ä»¶è¯»å–å’Œé¢„è§ˆ
        setTimeout(function() {
          showPreview();
        }, 1000);
      }
      
      function displayFileInfo(file) {
        var fileList = document.getElementById('fileList');
        var fileSize = (file.size / 1024 / 1024).toFixed(2) + 'MB';
        
        fileList.innerHTML = `
          <div class="file-item">
            <div class="file-icon">ğŸ“Š</div>
            <div class="file-info">
              <div class="file-name">${file.name}</div>
              <div class="file-size">å¤§å°: ${fileSize} | ç±»å‹: Excelæ–‡ä»¶</div>
              <div class="file-progress">
                <div class="layui-progress" lay-showpercent="yes">
                  <div class="layui-progress-bar layui-bg-blue" lay-percent="100%"></div>
                </div>
              </div>
            </div>
            <div class="file-actions">
              <button class="layui-btn layui-btn-xs layui-btn-normal" onclick="showPreview()">é¢„è§ˆ</button>
              <button class="layui-btn layui-btn-xs layui-btn-danger" onclick="removeFile()">åˆ é™¤</button>
            </div>
          </div>
        `;
      }
      
      function showPreview() {
        if (!currentFile) return;
        
        // æ˜¾ç¤ºé¢„è§ˆåŒºåŸŸ
        document.getElementById('previewSection').style.display = 'block';
        document.getElementById('settingsSection').style.display = 'block';
        document.getElementById('actionButtons').style.display = 'block';
        
        // æ¨¡æ‹ŸExcelæ•°æ®è§£æå’Œé¢„è§ˆ
        var mockPreviewData = [
          ['SKU', 'æœ€æ–°åº“å­˜', 'åŠ¨æ€åº“å­˜', 'æœ€æ–°åº“å­˜', 'åŠ¨æ€åº“å­˜', 'é”€å”®æ•°é‡', '06/25åˆå§‹å€¼', '07/07 11h3', '07/07 14h3', '07/08 11h3'],
          ['X00000567301XL', '0', '0', '0', '0', '0', '0', '10', '8', ''],
          ['X00000567302L', '0', '0', '0', '0', '32', '32', '10', '8', ''],
          ['X00000567302S', '0', '0', '0', '0', '0', '0', '', '', ''],
          ['X00000604404NA', '0', '0', '0', '0', '0', '0', '', '', ''],
          ['X00000604405NA', '24', '24', '24', '32', '19', '43', '36', '35', '33']
        ];
        
        var tableHtml = '';
        mockPreviewData.forEach(function(row, index) {
          var rowClass = index === 0 ? ' style="background: #f0f0f0; font-weight: bold;"' : '';
          tableHtml += '<tr' + rowClass + '>';
          row.forEach(function(cell) {
            var tag = index === 0 ? 'th' : 'td';
            tableHtml += '<' + tag + '>' + (cell || '') + '</' + tag + '>';
          });
          tableHtml += '</tr>';
        });
        
        document.getElementById('previewTable').innerHTML = tableHtml;
        
        layer.msg('æ–‡ä»¶è§£æå®Œæˆï¼Œè¯·æ£€æŸ¥æ•°æ®é¢„è§ˆ', {icon: 1});
      }
      
      window.removeFile = function() {
        currentFile = null;
        document.getElementById('fileList').innerHTML = '';
        document.getElementById('previewSection').style.display = 'none';
        document.getElementById('settingsSection').style.display = 'none';
        document.getElementById('actionButtons').style.display = 'none';
        document.getElementById('fileInput').value = '';
      };
      
      window.startImport = function() {
        if (!currentFile) {
          layer.msg('è¯·å…ˆé€‰æ‹©æ–‡ä»¶', {icon: 2});
          return;
        }
        
        var formSettings = form.val('importSettings');
        
        layer.confirm('ç¡®å®šè¦å¼€å§‹å¯¼å…¥æ•°æ®å—ï¼Ÿ<br><small>å¯¼å…¥æ–¹å¼ï¼š' + 
          (formSettings.importMode === 'replace' ? 'æ›¿æ¢ç°æœ‰æ•°æ®' : 'è¿½åŠ åˆ°ç°æœ‰æ•°æ®') + '</small>', 
          {icon: 3, title: 'ç¡®è®¤å¯¼å…¥'}, function(index){
          
          // æ˜¾ç¤ºå¯¼å…¥è¿›åº¦
          var loadIndex = layer.load(2, {content: 'æ­£åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œè¯·ç¨å€™...'});
          
          // åˆ›å»ºFormDataå¯¹è±¡
          var formData = new FormData();
          formData.append('file', currentFile);
          formData.append('description', 'é€šè¿‡æ•°æ®å¯¼å…¥é¡µé¢ä¸Šä¼ ');
          
          // è·å–JWTä»¤ç‰Œ
          var token = userInfo.token || localStorage.getItem('token');
          var headers = {};
          
          if (token) {
            headers['Authorization'] = 'Bearer ' + token;
          }
          
          // ä½¿ç”¨ç®€åŒ–çš„R2å­˜å‚¨ä¸Šä¼ 
          window.simpleR2Storage.uploadExcelFile(currentFile)
          .then(result => {
            layer.close(loadIndex);
            layer.close(index);
            
            if (result.success) {
              layer.alert('Excelæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼<br>' +
                'â€¢ æ–‡ä»¶åï¼š<strong>' + result.fileInfo.originalName + '</strong><br>' +
                'â€¢ æ–‡ä»¶å¤§å°ï¼š<strong>' + window.simpleR2Storage.formatFileSize(result.fileInfo.size) + '</strong><br>' +
                'â€¢ å­˜å‚¨ä½ç½®ï¼š<strong>R2/arc/</strong><br>' +
                'â€¢ ä¸Šä¼ æ—¶é—´ï¼š<strong>' + new Date(result.fileInfo.uploadTime).toLocaleString() + '</strong>', 
                {icon: 1, title: 'ä¸Šä¼ å®Œæˆ'}, function(){
                  // è·³è½¬åˆ°è¡¨æ ¼ç®¡ç†é¡µé¢
                  window.location.href = 'table-management.html';
                });
            } else {
              layer.msg('ä¸Šä¼ å¤±è´¥: ' + result.error, {icon: 2});
            }
          })
          .catch(error => {
            layer.close(loadIndex);
            layer.close(index);
            console.error('ä¸Šä¼ é”™è¯¯:', error);
            layer.msg('ä¸Šä¼ å¤±è´¥: ' + error.message, {icon: 2});
          });
        });
      };
      
      window.cancelImport = function() {
        window.location.href = 'dashboard.html';
      };
    });
    
    // é€€å‡ºç™»å½•
          function logout() {
        layer.confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ', {icon: 3, title: 'æç¤º'}, function(index){
          localStorage.removeItem('currentUser');
          layer.close(index);
          layer.msg('å·²å®‰å…¨é€€å‡ºï¼', {icon: 1}, function(){
            window.location.href = 'login.html';
          });
        });
      }
      
      // åˆ‡æ¢è´¦æˆ·
      function switchAccount() {
        layer.confirm('åˆ‡æ¢è´¦æˆ·å°†é€€å‡ºå½“å‰ç™»å½•ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ', {
          icon: 3, 
          title: 'åˆ‡æ¢è´¦æˆ·',
          btn: ['ç¡®å®š', 'å–æ¶ˆ']
        }, function(index) {
          localStorage.removeItem('currentUser');
          layer.close(index);
          layer.msg('æ­£åœ¨åˆ‡æ¢è´¦æˆ·...', {icon: 16, time: 1000}, function(){
            window.location.href = 'login.html';
          });
        });
      }
  </script>
</body>
</html> 